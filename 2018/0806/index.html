<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.113.0">
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Service Mesh :: compulsory thinking</title>

    
    <link href="/css/nucleus.css?1755015469" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1755015469" rel="stylesheet">
    <link href="/css/hybrid.css?1755015469" rel="stylesheet">
    <link href="/css/featherlight.min.css?1755015469" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1755015469" rel="stylesheet">
    <link href="/css/auto-complete.css?1755015469" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1755015469" rel="stylesheet">
    <link href="/css/theme.css?1755015469" rel="stylesheet">
    <link href="/css/tabs.css?1755015469" rel="stylesheet">
    <link href="/css/hugo-theme.css?1755015469" rel="stylesheet">
    
    <link href="/css/theme-blue.css?1755015469" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1755015469"></script>
      
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SXHZPRXGDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-SXHZPRXGDZ');
    </script>
    <script>
    if (location.host.indexOf("localhost") < 0 && location.protocol !== "https:") {
      location.protocol = "https:";
    }
    </script>
    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/2018/0806/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='/'>
  עֹז
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1755015469"></script>
<script type="text/javascript" src="/js/auto-complete.js?1755015469"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/opssec.in\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1755015469"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/2025/" title="2025" class="dd-item
        
        
        
        ">
      <a href="/2025/">
          2025
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/2025/0812/" title="Embracing Vibe Ops: AI-Driven Troubleshooting for ClusterAPI" class="dd-item
        
        
        
        ">
      <a href="/2025/0812/">
          Embracing Vibe Ops: AI-Driven Troubleshooting for ClusterAPI
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2024/" title="2024" class="dd-item
        
        
        
        ">
      <a href="/2024/">
          2024
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/2024/0201/" title="Kubernetes vSphere CSI on Windows" class="dd-item
        
        
        
        ">
      <a href="/2024/0201/">
          Kubernetes vSphere CSI on Windows
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2024/0104/" title="Kubernetes Windows Nodes" class="dd-item
        
        
        
        ">
      <a href="/2024/0104/">
          Kubernetes Windows Nodes
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2023/" title="2023" class="dd-item
        
        
        
        ">
      <a href="/2023/">
          2023
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/2023/1230/" title="Running Windows cluster locally" class="dd-item
        
        
        
        ">
      <a href="/2023/1230/">
          Running Windows cluster locally
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0801/" title="sigstore policy-controller validation" class="dd-item
        
        
        
        ">
      <a href="/2023/0801/">
          sigstore policy-controller validation
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0721/" title="Ztunnel SPIRE implementation" class="dd-item
        
        
        
        ">
      <a href="/2023/0721/">
          Ztunnel SPIRE implementation
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0702/" title="Waypoint Proxy for the app layer" class="dd-item
        
        
        
        ">
      <a href="/2023/0702/">
          Waypoint Proxy for the app layer
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0630/" title="Ztunnel on Ambient Mesh" class="dd-item
        
        
        
        ">
      <a href="/2023/0630/">
          Ztunnel on Ambient Mesh
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0628/" title="Istio CNI on Ambient Mesh" class="dd-item
        
        
        
        ">
      <a href="/2023/0628/">
          Istio CNI on Ambient Mesh
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0622/" title="Istio Ambient Service Mesh Demo" class="dd-item
        
        
        
        ">
      <a href="/2023/0622/">
          Istio Ambient Service Mesh Demo
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0611/" title="SPIFFE/SPIRE for gRPC authz" class="dd-item
        
        
        
        ">
      <a href="/2023/0611/">
          SPIFFE/SPIRE for gRPC authz
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0608/" title="Secure gRPC services with mTLS" class="dd-item
        
        
        
        ">
      <a href="/2023/0608/">
          Secure gRPC services with mTLS
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0406/" title="Windows CNI tracing and deep dive" class="dd-item
        
        
        
        ">
      <a href="/2023/0406/">
          Windows CNI tracing and deep dive
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0330/" title="Windows Containers and .NET apps" class="dd-item
        
        
        
        ">
      <a href="/2023/0330/">
          Windows Containers and .NET apps
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0322/" title="Multi AZ on Kubernetes and vSphere" class="dd-item
        
        
        
        ">
      <a href="/2023/0322/">
          Multi AZ on Kubernetes and vSphere
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2022/" title="2022" class="dd-item
        
        
        
        ">
      <a href="/2022/">
          2022
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/2022/0712/" title="Hybrid nodes with ClusterClass on Amazon Web Service" class="dd-item
        
        
        
        ">
      <a href="/2022/0712/">
          Hybrid nodes with ClusterClass on Amazon Web Service
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2022/0610/" title="Border Gateway Protocol (BGP) and Kubernetes" class="dd-item
        
        
        
        ">
      <a href="/2022/0610/">
          Border Gateway Protocol (BGP) and Kubernetes
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2022/0320/" title="Cluster API Provider for Azure" class="dd-item
        
        
        
        ">
      <a href="/2022/0320/">
          Cluster API Provider for Azure
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2022/0122/" title="Kube-Proxy Next Gen Windows Userspace" class="dd-item
        
        
        
        ">
      <a href="/2022/0122/">
          Kube-Proxy Next Gen Windows Userspace
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2021/" title="2021" class="dd-item
        
        
        
        ">
      <a href="/2021/">
          2021
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/2021/1218/" title="Kube-proxy Windows Kernelspace Mode" class="dd-item
        
        
        
        ">
      <a href="/2021/1218/">
          Kube-proxy Windows Kernelspace Mode
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/1127/" title="Kube-proxy Linux Userspace Mode" class="dd-item
        
        
        
        ">
      <a href="/2021/1127/">
          Kube-proxy Linux Userspace Mode
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/1017/" title="Kube-proxy Winuserspace Mode" class="dd-item
        
        
        
        ">
      <a href="/2021/1017/">
          Kube-proxy Winuserspace Mode
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/0903/" title="Windows and Calico overlay networking" class="dd-item
        
        
        
        ">
      <a href="/2021/0903/">
          Windows and Calico overlay networking
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/0828/" title="CNI plugins and kindnet" class="dd-item
        
        
        
        ">
      <a href="/2021/0828/">
          CNI plugins and kindnet
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/0614/" title="Kube-proxy ClusterIP" class="dd-item
        
        
        
        ">
      <a href="/2021/0614/">
          Kube-proxy ClusterIP
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/0228/" title="Kubernetes Windows Nodes" class="dd-item
        
        
        
        ">
      <a href="/2021/0228/">
          Kubernetes Windows Nodes
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2020/" title="2020" class="dd-item
        
        
        
        ">
      <a href="/2020/">
          2020
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2020/1227/" title="Network Policy E2E test suite" class="dd-item ">
        <a href="/2020/1227/">
        Network Policy E2E test suite
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2020/2405/" title="Kubelet Dynamic Configuration" class="dd-item ">
        <a href="/2020/2405/">
        Kubelet Dynamic Configuration
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2020/1005/" title="Kubelet Debugging Session" class="dd-item ">
        <a href="/2020/1005/">
        Kubelet Debugging Session
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2019/" title="2019" class="dd-item
        
        
        
        ">
      <a href="/2019/">
          2019
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2019/1228/" title="Kubernetes Networking 101" class="dd-item ">
        <a href="/2019/1228/">
        Kubernetes Networking 101
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/12282/" title="Kubernetes Deployment Workloads" class="dd-item ">
        <a href="/2019/12282/">
        Kubernetes Deployment Workloads
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/12283/" title="Kubernetes Container API" class="dd-item ">
        <a href="/2019/12283/">
        Kubernetes Container API
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1227/" title="Pod specification" class="dd-item ">
        <a href="/2019/1227/">
        Pod specification
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1226/" title="Kubectl Walkthrough" class="dd-item ">
        <a href="/2019/1226/">
        Kubectl Walkthrough
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1225/" title="Kubernetes in Docker" class="dd-item ">
        <a href="/2019/1225/">
        Kubernetes in Docker
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1215/" title="Sawtooth Cheatsheet" class="dd-item ">
        <a href="/2019/1215/">
        Sawtooth Cheatsheet
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1208/" title="Sawtooth Permissioning" class="dd-item ">
        <a href="/2019/1208/">
        Sawtooth Permissioning
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1127/" title="Kubernetes Audit Sink" class="dd-item ">
        <a href="/2019/1127/">
        Kubernetes Audit Sink
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1123/" title="Kubernetes API client" class="dd-item ">
        <a href="/2019/1123/">
        Kubernetes API client
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/11161/dev-poet/" title="From Dev to PoET" class="dd-item ">
        <a href="/2019/11161/dev-poet/">
        From Dev to PoET
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1116/" title="Sawtooth Network Monitoring" class="dd-item ">
        <a href="/2019/1116/">
        Sawtooth Network Monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1111/" title="Gossip networks" class="dd-item ">
        <a href="/2019/1111/">
        Gossip networks
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2018/" title="2018" class="dd-item
        parent
        
        
        ">
      <a href="/2018/">
          2018
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2018/08072/" title="Golang essays (part II)" class="dd-item ">
        <a href="/2018/08072/">
        Golang essays (part II)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0807/" title="Golang essays (part I)" class="dd-item ">
        <a href="/2018/0807/">
        Golang essays (part I)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0704/langs2/" title="Rust 101" class="dd-item ">
        <a href="/2018/0704/langs2/">
        Rust 101
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0602/sawtooth/" title="Hyperledger Sawtooth" class="dd-item ">
        <a href="/2018/0602/sawtooth/">
        Hyperledger Sawtooth
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0527/langs1/" title="Bootstraping languages" class="dd-item ">
        <a href="/2018/0527/langs1/">
        Bootstraping languages
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0806/" title="Service Mesh" class="dd-item active">
        <a href="/2018/0806/">
        Service Mesh
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0325/" title="Technical indicators" class="dd-item ">
        <a href="/2018/0325/">
        Technical indicators
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2017/" title="2017" class="dd-item
        
        
        
        ">
      <a href="/2017/">
          2017
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2017/1012/" title="More statistics and Python" class="dd-item ">
        <a href="/2017/1012/">
        More statistics and Python
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2017/0701/" title="Probability" class="dd-item ">
        <a href="/2017/0701/">
        Probability
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2017/0625/" title="Statistics and Python" class="dd-item ">
        <a href="/2017/0625/">
        Statistics and Python
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2016/" title="2016" class="dd-item
        
        
        
        ">
      <a href="/2016/">
          2016
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2016/1216/apk/" title="Android APK hacking" class="dd-item ">
        <a href="/2016/1216/apk/">
        Android APK hacking
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2016/1127/" title="Continuous Deployment and DEIS" class="dd-item ">
        <a href="/2016/1127/">
        Continuous Deployment and DEIS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2016/0618/ecto/" title="Ecto vs. Django ORM" class="dd-item ">
        <a href="/2016/0618/ecto/">
        Ecto vs. Django ORM
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2016/0416/cpython/" title="CPython Debugging" class="dd-item ">
        <a href="/2016/0416/cpython/">
        CPython Debugging
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2016/0123/" title="Golang vs. Python" class="dd-item ">
        <a href="/2016/0123/">
        Golang vs. Python
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2016/0116/" title="Monitoring MySQL w/ Prometheus" class="dd-item ">
        <a href="/2016/0116/">
        Monitoring MySQL w/ Prometheus
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2015/" title="2015" class="dd-item
        
        
        
        ">
      <a href="/2015/">
          2015
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2015/0309/consul/" title="Consul - Service Discovery" class="dd-item ">
        <a href="/2015/0309/consul/">
        Consul - Service Discovery
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2015/0908/finance/" title="General finance formulas" class="dd-item ">
        <a href="/2015/0908/finance/">
        General finance formulas
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2015/2607/" title="Tsung Capacity Test" class="dd-item ">
        <a href="/2015/2607/">
        Tsung Capacity Test
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      <center>
  <p><b>Amim Knabben</b> - 2025</p>
    amim.knabben@gmail.com
  <br/>
  <a href="https://github.com/knabben"><i class="fab fa-github"></i></a>
  <a href="https://twitter.com/ak_ndb"><i class="fab fa-twitter"></i></a>
  <a href="https://linkedin.com/in/amim"><i class="fab fa-linkedin"></i></a>
</center>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'></a> > <a href='/2018/'>2018</a> > Service Mesh
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li><a href="#headline-1">Introducing Kubernetes</a>
</li>
<li><a href="#headline-2">Getting started</a>
</li>
<li><a href="#headline-3">Problems</a>
<ul>
<li><a href="#headline-4">Monitoring</a>
</li>
<li><a href="#headline-5">Service Discovery</a>
</li>
<li><a href="#headline-6">Shared configuration</a>
</li>
<li><a href="#headline-7">Volume persistence</a>
</li>
<li><a href="#headline-8">Downtime deployments</a>
</li>
</ul>
</li>
<li><a href="#headline-9">Service mesh</a>
<ul>
<li><a href="#headline-10">Pre - requisites for this tutorial</a>
<ul>
<li><a href="#headline-11">[1] Kubernetes</a>
</li>
<li><a href="#headline-12">[2] Istio</a>
</li>
<li><a href="#headline-13">[3] GRPC gateway</a>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#headline-14">The GRPC gateway</a>
</li>
<li><a href="#headline-15">Istio</a>
<ul>
<li><a href="#headline-16">Pilot - provides service discovery for the Envoy sidecars, traffic management capabilities for intelligent routing.</a>
</li>
<li><a href="#headline-17">Mixer - a platform-independent component responsible for enforcing access control and usage policies across the service mesh and collecting telemetry data from the Envoy proxy and other services.</a>
</li>
<li><a href="#headline-18">Istio-Auth - provides strong service-to-service and end-user authentication using mutual TLS, with built-in identity and credential management.</a>
</li>
</ul>
</li>
<li><a href="#headline-19">Istio components</a>
<ul>
<li><a href="#headline-20">The automatic initializer</a>
</li>
<li><a href="#headline-21">Service access and Ingress</a>
</li>
<li><a href="#headline-22">Metrics</a>
</li>
<li><a href="#headline-23">Custom HTTP metric</a>
</li>
<li><a href="#headline-24">Playing around with Mixer adapter</a>
</li>
</ul>
</li>
<li><a href="#headline-25">Reference</a>
<ul>
<li><a href="#headline-26">[1] https://github.com/kelseyhightower/kubernetes-the-hard-way</a>
</li>
<li><a href="#headline-27">[2] http://blog.christianposta.com/istio-workshop/slides/#/title</a>
</li>
<li><a href="#headline-28">[3] https://github.com/knabben/grpc-ex</a>
</li>
<li><a href="#headline-29">[4] https://istio.io/docs/setup/kubernetes/quick-start-gke-dm.html</a>
</li>
<li><a href="#headline-30">[5] https://istio.io/docs/setup/kubernetes/sidecar-injection.html#automatic-sidecar-injection</a>
</li>
</ul>
</li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Service Mesh
            </h1>
          

        



<div id="outline-container-headline-1" class="outline-3">
<h3 id="headline-1">
Introducing Kubernetes
</h3>
<div id="outline-text-headline-1" class="outline-text-3">
<p>
November 2015, I started to use containers in production, and found some crazy problems involved with this in the process, it went from service discovery to persistent storage in a few days. The environment I used were basically a CoreOS cluster with some peculiarities, like starting services remote with fleet (like kubectl). The setup were composed of a etcd/fleet cluster with 3 machines and units being deployed with an external FLEETCTL_TUNNEL variable.</p>
<p>
Trying to create an orchestration system by hand looked like a mad task as you can read on the last posts, at least it was a lot of fun, some of the problems I faced with the setup are:</p>
<ol>
<li>Downtime - My container ran on a single machine, when I stopped the unit and started again via fleetctl I had the bootstrap time and the new docker pull couting as a downtime of the service.</li>
<li>Volume persistence - This is a real pain, the volume mounted on a machine stays on there if the docker is killed, I had to do some X-fleet units hack to keep the container always on that machine.</li>
<li>Shared configurations - it were solved with etcd</li>
<li>Service discovery - A consul + registration + workarounds</li>
<li>Monitoring - A painful (cadvisor + prometheus + alertmanager) setup</li>
</ol>
<p>But as stated on [1], &#34;With the realization that large, expensive, proprietary supercomputers are being replaced by a clusters of commodity boxes running Linux (commoditization), at a fraction of the cost, it is not too much of a stretch to see apllication of this type of technology widespread in the engineering and traditional IT world. The availability of commodity clusters make it possible for small research organizations, It deps, and engineering groups to have their own supercomupters at a fraction of the cost previously required for the equivalten computing capability.&#34;</p>
<p>
The last definition of a cluster from the same book is: &#34;A closely coupled collection of computer systems that shares a common infrastructure and provides a parallel set of resources to services or applications.&#34;</p>
<p>
For the problems above (at least) and at the same time a software that fits well on the description is <strong>Kubernetes</strong>.  I could say a container orchestration abstraction layer for the masses. We are not using Maui Cluster Scheduler, ganglia or Nagios anymore, but the core concepts still remains the same.</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-3">
<h3 id="headline-2">
Getting started
</h3>
<div id="outline-text-headline-2" class="outline-text-3">
<p>
You can start in a few ways, if you want a single machine to play around try minikube or vagrant, if you have some resources you can use kube-aws to setup an AWS cluster with CoreOS or go with get.k8s.io. The brave ones can test the hack/local-up-cluster.sh and RTFM +1 for this option.</p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-3">
<h3 id="headline-3">
Problems
</h3>
<div id="outline-text-headline-3" class="outline-text-3">
<div id="outline-container-headline-4" class="outline-4">
<h4 id="headline-4">
Monitoring
</h4>
<div id="outline-text-headline-4" class="outline-text-4">
<p>
Here is where Prometheus [2] shines. Sysdig [3] is other technology that is integrating very well with kubernetes nowadays, it can be used for deep pod inspection from the replica set to end process syscall, pretty cool.</p>
<p>
Want to see how to deploy the Prometheus stack go to the CoreOS blog [3]. Well, this is really content for another post.</p>
</div>
</div>
<div id="outline-container-headline-5" class="outline-4">
<h4 id="headline-5">
Service Discovery
</h4>
<div id="outline-text-headline-5" class="outline-text-4">
<p>
Kubernetes uses kube-dns, a SkyDNS based solution to create automatic registers of the existent services, so you can reach other pods on differents namespaces like - my-svc.my-namespace.svc.cluster.local, with kube-aws each pod uses it as a default nameserver.</p>
</div>
</div>
<div id="outline-container-headline-6" class="outline-4">
<h4 id="headline-6">
Shared configuration
</h4>
<div id="outline-text-headline-6" class="outline-text-4">
<p>
Kubernetes have two kinds of sharing data, with the old setup we passed variables to systemd units and had to encrypt the .service files with Blackbox for example before commiting to git, now we have ConfigMaps, key/values pairs of configuration data, think of .ini files shared between the pods on the cluster. We can use secrets and import both on pods specification like</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">USE_CRON</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">valueFrom</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">configMapKeyRef</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">cron-data</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">key</span>: <span style="color:#ae81ff">use_cron</span></span></span></code></pre></div></p>
</div>
</div>
<div id="outline-container-headline-7" class="outline-4">
<h4 id="headline-7">
Volume persistence
</h4>
<div id="outline-text-headline-7" class="outline-text-4">
<p>
On AWS when you create a POD as part of the specification one can use, the volume goes to other machine if the pod is reeschuleded:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumeMounts</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">mountPath</span>: <span style="color:#ae81ff">/var/log/nginx</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx-log</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx-log</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">awsElasticBlockStore</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">volumeID</span>: <span style="color:#ae81ff">vol-333333</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">fsType</span>: <span style="color:#ae81ff">ext4</span></span></span></code></pre></div></p>
</div>
</div>
<div id="outline-container-headline-8" class="outline-4">
<h4 id="headline-8">
Downtime deployments
</h4>
<div id="outline-text-headline-8" class="outline-text-4">
<p>
It uses the idea of deployments for replicasets and pods, in a descriptive form you just say the final state you want your pods to have. You can edit an existing template, or simple set a new container image like:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>kubectl set image deployment/nginx-deployment nginx<span style="color:#f92672">=</span>nginx:1.9.1
</span></span><span style="display:flex;"><span>deployment <span style="color:#e6db74">&#34;nginx-deployment&#34;</span> image updated</span></span></code></pre></div></p>
<p>
From deployments documentation [5]:</p>
<p>
You will see that it first created a new Pod, then deleted some old Pods and created new ones. It does not kill old Pods until a sufficient number of new Pods have come up, and does not create new Pods until a sufficient number of old Pods have been killed</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-9" class="outline-3">
<h3 id="headline-9">
Service mesh
</h3>
<div id="outline-text-headline-9" class="outline-text-3">
<p>
Microservices cluster management complexity grows easily while your app evolve, questions like how to track the request between services, how to apply A/B tests, how to add metrics for services without changing any code on your application are common when deploying containers on an orchestrator. L4/L7 proxies try to solve these problems in an elegant way.</p>
<div id="outline-container-headline-10" class="outline-4">
<h4 id="headline-10">
Pre - requisites for this tutorial
</h4>
<div id="outline-text-headline-10" class="outline-text-4">
<p>
On the assumption that all systems bellow are installed and working A.K.A you are able to access a running Kubernetes cluster with Istio:</p>
<div id="outline-container-headline-11" class="outline-6">
<h6 id="headline-11">
[1] Kubernetes
</h6>
</div>
<div id="outline-container-headline-12" class="outline-6">
<h6 id="headline-12">
[2] Istio
</h6>
</div>
<div id="outline-container-headline-13" class="outline-6">
<h6 id="headline-13">
[3] GRPC gateway
</h6>
<div id="outline-text-headline-13" class="outline-text-6">
<p>
I really recommend doing the workshops and exercises above but if you don&#39;t have the motivation to run the stack step by step, try [4], Google Cloud Platform offers 300 USD of credits with an automatic Istio deployment interface.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-14" class="outline-3">
<h3 id="headline-14">
The GRPC gateway
</h3>
<div id="outline-text-headline-14" class="outline-text-3">
<p>
For this example we will deploy 2 different services, the first POD offers a simple GRPC server, the second POD offers a REST API gateway for the GRPC server.</p>
</div>
</div>
<div id="outline-container-headline-15" class="outline-3">
<h3 id="headline-15">
Istio
</h3>
<div id="outline-text-headline-15" class="outline-text-3">
<p>
From the oficial documentation: Istio provides an easy way to create a network of deployed services with load balancing, service-to-service authentication, monitoring, and more, without requiring any changes in service code. <strong>You add Istio support to services by deploying a special sidecar proxy throughout your environment that intercepts all network communication between microservices, configured and managed using Istio’s control plane functionality.</strong></p>
<p>
Long story short: This special sidecar proxy is injected on each pod, basically it&#39;s a modified and dynamic configured envoy (data plane), the other part of this mesh stack is the control plane composed by:</p>
<div id="outline-container-headline-16" class="outline-6">
<h6 id="headline-16">
Pilot - provides service discovery for the Envoy sidecars, traffic management capabilities for intelligent routing.
</h6>
</div>
<div id="outline-container-headline-17" class="outline-6">
<h6 id="headline-17">
Mixer - a platform-independent component responsible for enforcing access control and usage policies across the service mesh and collecting telemetry data from the Envoy proxy and other services.
</h6>
</div>
<div id="outline-container-headline-18" class="outline-6">
<h6 id="headline-18">
Istio-Auth - provides strong service-to-service and end-user authentication using mutual TLS, with built-in identity and credential management.
</h6>
<div id="outline-text-headline-18" class="outline-text-6">
<p>
The official documentation is full of good resources and information, our goal here is to be more pragmatic and have some overview and details of Istio capabilities.</p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-19" class="outline-3">
<h3 id="headline-19">
Istio components
</h3>
<div id="outline-text-headline-19" class="outline-text-3">
<p>
After installing Istio you can see the following PODS on istio-system ns. </p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>kubectl get pods --namespace istio-system
</span></span><span style="display:flex;"><span>NAME                                 READY     STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>grafana-2369932619-9nsjq             1/1       Running   <span style="color:#ae81ff">0</span>          17h
</span></span><span style="display:flex;"><span>istio-ca-191975193-tk62c             1/1       Running   <span style="color:#ae81ff">0</span>          17h
</span></span><span style="display:flex;"><span>istio-ingress-596799894-40g4p        1/1       Running   <span style="color:#ae81ff">0</span>          17h
</span></span><span style="display:flex;"><span>istio-initializer-2169589188-35lfx   1/1       Running   <span style="color:#ae81ff">0</span>          17h
</span></span><span style="display:flex;"><span>istio-mixer-3168313471-0svbr         3/3       Running   <span style="color:#ae81ff">0</span>          17h
</span></span><span style="display:flex;"><span>istio-pilot-2277488234-j270h         2/2       Running   <span style="color:#ae81ff">0</span>          17h
</span></span><span style="display:flex;"><span>prometheus-168775884-t7zhd           1/1       Running   <span style="color:#ae81ff">0</span>          17h
</span></span><span style="display:flex;"><span>servicegraph-2857261069-6d2vg        1/1       Running   <span style="color:#ae81ff">0</span>          17h
</span></span><span style="display:flex;"><span>zipkin-3660596538-92wv9              1/1       Running   <span style="color:#ae81ff">0</span>          17h</span></span></code></pre></div></p>
<p>
### Istio automatic initializer</p>
<p>
First, lets take a look on istio-initializer [5], running this POD enable us to automaticaly do the sidecar injection with this disable we need manually recreate the YAML files with istioctl kube-inject command, lets try to see the logs of this pod:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>kubectl logs istio-initializer-2169589188-35lfx -n istio-system
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>http.go:100<span style="color:#f92672">]</span> Starting HTTP service at :8083                                                                       
</span></span><span style="display:flex;"><span>initializer.go:229<span style="color:#f92672">]</span> Starting Istio sidecar initializer...
</span></span><span style="display:flex;"><span>initializer.go:230<span style="color:#f92672">]</span> Initializer name set to: sidecar.initializer.istio.io
</span></span><span style="display:flex;"><span>initializer.go:233<span style="color:#f92672">]</span> Supported kinds:
</span></span><span style="display:flex;"><span>initializer.go:238<span style="color:#f92672">]</span>     /v1 ReplicationController
</span></span><span style="display:flex;"><span>initializer.go:238<span style="color:#f92672">]</span>     extensions/v1beta1 Deployment
</span></span><span style="display:flex;"><span>initializer.go:238<span style="color:#f92672">]</span>     extensions/v1beta1 DaemonSet
</span></span><span style="display:flex;"><span>initializer.go:238<span style="color:#f92672">]</span>     extensions/v1beta1 ReplicaSet
</span></span><span style="display:flex;"><span>initializer.go:238<span style="color:#f92672">]</span>     batch/v1 Job
</span></span><span style="display:flex;"><span>initializer.go:238<span style="color:#f92672">]</span>     batch/v2alpha1 CronJob
</span></span><span style="display:flex;"><span>initializer.go:238<span style="color:#f92672">]</span>     apps/v1beta1 StatefulSet
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># After running</span>
</span></span><span style="display:flex;"><span>helm install --name grpc ./chart
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>initializer.go:174<span style="color:#f92672">]</span> ObjectMeta initializer info extensions/v1beta1, Kind<span style="color:#f92672">=</span>Deployment default/http-serve policy:<span style="color:#e6db74">&#34;&#34;</span> status:<span style="color:#e6db74">&#34;&#34;</span> &amp;Initializers<span style="color:#f92672">{</span>Pending:<span style="color:#f92672">[{</span>sidecar.initializer.istio.io<span style="color:#f92672">}]</span>,Result:nil,<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>inject.go:302<span style="color:#f92672">]</span> Sidecar injection policy <span style="color:#66d9ef">for</span> default/http-serve: namespacePolicy:enabled useDefault:true inject:false status:<span style="color:#e6db74">&#34;&#34;</span> required:true
</span></span><span style="display:flex;"><span>initializer.go:174<span style="color:#f92672">]</span> ObjectMeta initializer info extensions/v1beta1, Kind<span style="color:#f92672">=</span>ReplicaSet default/http-serve-1172935448 policy:<span style="color:#e6db74">&#34;&#34;</span> status:<span style="color:#e6db74">&#34;injected-version-0.3.0&#34;</span> nil
</span></span><span style="display:flex;"><span>initializer.go:174<span style="color:#f92672">]</span> ObjectMeta initializer info extensions/v1beta1, Kind<span style="color:#f92672">=</span>Deployment default/grpc-internal policy:<span style="color:#e6db74">&#34;&#34;</span> status:<span style="color:#e6db74">&#34;&#34;</span> &amp;Initializers<span style="color:#f92672">{</span>Pending:<span style="color:#f92672">[{</span>sidecar.initializer.istio.io<span style="color:#f92672">}]</span>,Result:nil,<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>inject.go:302<span style="color:#f92672">]</span> Sidecar injection policy <span style="color:#66d9ef">for</span> default/grpc-internal: namespacePolicy:enabled useDefault:true inject:false status:<span style="color:#e6db74">&#34;&#34;</span> required:true
</span></span><span style="display:flex;"><span>initializer.go:174<span style="color:#f92672">]</span> ObjectMeta initializer info extensions/v1beta1, Kind<span style="color:#f92672">=</span>ReplicaSet default/grpc-internal-2913712020 policy:<span style="color:#e6db74">&#34;&#34;</span> status:<span style="color:#e6db74">&#34;injected-version-0.3.0&#34;</span> nil</span></span></code></pre></div></p>
<p>
If you describe the pod you can see the istio-proxy sidecar attached to the main container.</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>grpc:
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>istio-proxy:
</span></span><span style="display:flex;"><span>    Image:         docker.io/istio/proxy_debug:0.3.0
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    Args:
</span></span><span style="display:flex;"><span>      proxy
</span></span><span style="display:flex;"><span>      sidecar
</span></span><span style="display:flex;"><span>      -v
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>      --configPath
</span></span><span style="display:flex;"><span>      /etc/istio/proxy
</span></span><span style="display:flex;"><span>      --serviceCluster
</span></span><span style="display:flex;"><span>      http-serve
</span></span><span style="display:flex;"><span>      --discoveryAddress
</span></span><span style="display:flex;"><span>      istio-pilot.istio-system:15003
</span></span><span style="display:flex;"><span>      --zipkinAddress
</span></span><span style="display:flex;"><span>      zipkin.istio-system:9411
</span></span><span style="display:flex;"><span>      --statsdUdpAddress
</span></span><span style="display:flex;"><span>      istio-mixer.istio-system:9125
</span></span><span style="display:flex;"><span>      ...
</span></span><span style="display:flex;"><span>    State:          Running
</span></span><span style="display:flex;"><span>    ...</span></span></code></pre></div></p>
<div id="outline-container-headline-20" class="outline-4">
<h4 id="headline-20">
The automatic initializer
</h4>
<div id="outline-text-headline-20" class="outline-text-4">
<p>
This is a very interesting use of Kubernetes Initializer, here occurs the injection of the proxy sidecar before starting the pod.</p>
<ol>
<li>kubernetes adds sidecar.initializer.istio.io to the list of pending initializers in the workload.</li>
</ol>
<p>This is achieved by the following InitializerConfiguration, that comes with Istio setup:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">admissionregistration.k8s.io/v1alpha1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">InitializerConfiguration</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">istio-sidecar</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">initializers</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">sidecar.initializer.istio.io</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rules</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">apiGroups</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#e6db74">&#34;*&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">apiVersions</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#e6db74">&#34;*&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">resources</span>:
</span></span><span style="display:flex;"><span>          - <span style="color:#ae81ff">deployments</span>
</span></span><span style="display:flex;"><span>          - <span style="color:#ae81ff">statefulsets</span>
</span></span><span style="display:flex;"><span>          - <span style="color:#ae81ff">jobs</span>
</span></span><span style="display:flex;"><span>          - <span style="color:#ae81ff">daemonsets</span>
</span></span><span style="display:flex;"><span>---</span></span></code></pre></div></p>
<ol>
<li>istio-initializer controller observes a new uninitialized workload was created. It finds its configured name sidecar.initializer.istio.io as the first in the list of pending initializers.</li>
</ol>
<p>The [NewInitializer](<a href="https://github.com/istio/istio/blob/master/pilot/platform/kube/inject/initializer.go#L94)">https://github.com/istio/istio/blob/master/pilot/platform/kube/inject/initializer.go#L94)</a> function uses the [ListWatch](<a href="https://github.com/kubernetes/client-go/blob/master/tools/cache/listwatch.go#L52)">https://github.com/kubernetes/client-go/blob/master/tools/cache/listwatch.go#L52)</a> struct, to monitor the new resources created:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span><span style="color:#75715e">// ListWatch knows how to list and watch a set of apiserver resources.  It satisfies the ListerWatcher interface.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// It is a convenience function for users of NewReflector, etc.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// ListFunc and WatchFunc must not be nil
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ListWatch</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ListFunc</span>  <span style="color:#a6e22e">ListFunc</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">WatchFunc</span> <span style="color:#a6e22e">WatchFunc</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// DisableChunking requests no chunking for this list watcher.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">DisableChunking</span> <span style="color:#66d9ef">bool</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Snippet of watcher including the Uninitialized assets.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">WatchFunc</span>: <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">options</span> <span style="color:#a6e22e">metav1</span>.<span style="color:#a6e22e">ListOptions</span>) (<span style="color:#a6e22e">watch</span>.<span style="color:#a6e22e">Interface</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">IncludeUninitialized</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">Watch</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">options</span>.<span style="color:#a6e22e">FieldSelector</span> = <span style="color:#a6e22e">fields</span>.<span style="color:#a6e22e">Everything</span>().<span style="color:#a6e22e">String</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">kindClient</span>.<span style="color:#a6e22e">Get</span>().
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Namespace</span>(<span style="color:#a6e22e">v1</span>.<span style="color:#a6e22e">NamespaceAll</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Resource</span>(<span style="color:#a6e22e">kind</span>.<span style="color:#a6e22e">resource</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">VersionedParams</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">options</span>, <span style="color:#a6e22e">metav1</span>.<span style="color:#a6e22e">ParameterCodec</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Watch</span>()
</span></span><span style="display:flex;"><span>},</span></span></code></pre></div></p>
<ol>
<li>istio-initializer checks to see if it was responsible for initializing workloads in the namespace of the workload. No further work is done and the initializer ignores the workload if the initializer is not configured for the namespace. By default the initializer is responsible for all namespaces (see configuration options).</li>
</ol>
<p>The function [injectRequired](<a href="https://github.com/istio/istio/blob/master/pilot/platform/kube/inject/inject.go#L232)">https://github.com/istio/istio/blob/master/pilot/platform/kube/inject/inject.go#L232)</a> above is responsible to check the namespace.</p>
<ol>
<li>istio-initializer removes itself from the list of pending initializers. Kubernetes will not finish creating workloads if the list of pending initializers is non-empty. A misconfigured initializer means a broken cluster.</li>
</ol>
<p>The function [initialize](<a href="https://github.com/istio/istio/blob/master/pilot/platform/kube/inject/initializer.go#L202)">https://github.com/istio/istio/blob/master/pilot/platform/kube/inject/initializer.go#L202)</a> (handler from watch) is responsible to remove itself from pending initializer.</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Remove self from the list of pending Initializers while
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// preserving ordering.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pending</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">GetInitializers</span>().<span style="color:#a6e22e">Pending</span>; len(<span style="color:#a6e22e">pending</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">SetInitializers</span>(<span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">GetInitializers</span>().<span style="color:#a6e22e">Pending</span> = append(<span style="color:#a6e22e">pending</span>[:<span style="color:#ae81ff">0</span>], <span style="color:#a6e22e">pending</span>[<span style="color:#ae81ff">1</span>:]<span style="color:#f92672">...</span>)
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></p>
<ol>
<li>istio-initializer checks the default injection policy for the mesh and any possible per-workload overrides to determine whether the sidecar should be injected.</li>
</ol>
<p>The function [injectRequired](<a href="https://github.com/istio/istio/blob/master/pilot/platform/kube/inject/inject.go#L270)">https://github.com/istio/istio/blob/master/pilot/platform/kube/inject/inject.go#L270)</a> defines the default injection policy</p>
<ol>
<li>istio-initializer injects the sidecar template into the workload and submits it back to kubernetes via PATCH.</li>
</ol>
<p>The patcher is passed to the [event handler function](<a href="https://github.com/istio/istio/blob/master/pilot/platform/kube/inject/initializer.go#L224):">https://github.com/istio/istio/blob/master/pilot/platform/kube/inject/initializer.go#L224):</a></p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">return</span> <span style="color:#a6e22e">patcher</span>(<span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">GetNamespace</span>(), <span style="color:#a6e22e">obj</span>.<span style="color:#a6e22e">GetName</span>(), <span style="color:#a6e22e">patchBytes</span>, <span style="color:#a6e22e">rObj</span>)</span></span></code></pre></div></p>
<ol>
<li>kubernetes finishes creating the workload as normal and the workload includes the injected sidecar.</li>
</ol>
</div>
</div>
<div id="outline-container-headline-21" class="outline-4">
<h4 id="headline-21">
Service access and Ingress
</h4>
<div id="outline-text-headline-21" class="outline-text-4">
<p>
You can access the service with port-forward yet:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>kubectl port-forward http-serve-1172935448-zw527 8080:8080
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Accessing http://localhost:8080/v1/health</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HTTP/1.1 <span style="color:#ae81ff">200</span> OK
</span></span><span style="display:flex;"><span>&lt; Date: Mon, <span style="color:#ae81ff">01</span> Jan <span style="color:#ae81ff">2018</span> 12:53:02 GMT
</span></span><span style="display:flex;"><span>&lt; Content-Length: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>&lt; Content-Type: text/plain; charset<span style="color:#f92672">=</span>utf-8
</span></span><span style="display:flex;"><span>&lt;
</span></span><span style="display:flex;"><span>OK</span></span></code></pre></div></p>
<p>
For external access you can use the Istio Ingress Controller (with the kubernetes.io/ingress.class: istio annotation). The ingress looks like:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>Name:             simple-ingress
</span></span><span style="display:flex;"><span>Namespace:        default
</span></span><span style="display:flex;"><span>Address:          35.202.0.31
</span></span><span style="display:flex;"><span>Default backend:  default-http-backend:80 <span style="color:#f92672">(</span>10.56.0.4:8080<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Rules:
</span></span><span style="display:flex;"><span>  Host  Path  Backends
</span></span><span style="display:flex;"><span>  ----  ----  --------
</span></span><span style="display:flex;"><span>  *
</span></span><span style="display:flex;"><span>        /v1/.*   http-serve:8080 <span style="color:#f92672">(</span>&lt;none&gt;<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                 grpc-internal:9090 <span style="color:#f92672">(</span>&lt;none&gt;<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Access the server via your cluster external IP, note the envoy added headers:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt; HTTP/1.1 <span style="color:#ae81ff">200</span> OK
</span></span><span style="display:flex;"><span>&lt; date: Mon, <span style="color:#ae81ff">01</span> Jan <span style="color:#ae81ff">2018</span> 12:52:39 GMT
</span></span><span style="display:flex;"><span>&lt; content-length: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>&lt; content-type: text/plain; charset<span style="color:#f92672">=</span>utf-8
</span></span><span style="display:flex;"><span>&lt; x-envoy-upstream-service-time: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>&lt; server: envoy
</span></span><span style="display:flex;"><span>&lt;
</span></span><span style="display:flex;"><span>OK</span></span></code></pre></div></p>
</div>
</div>
<div id="outline-container-headline-22" class="outline-4">
<h4 id="headline-22">
Metrics
</h4>
<div id="outline-text-headline-22" class="outline-text-4">
<p>
Start the loop curl request and checkout the servicegraph, based on prometheus data.</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#66d9ef">while</span> true; <span style="color:#66d9ef">do</span> curl -d <span style="color:#e6db74">&#39;{&#34;value&#34;:  &#34;myvalue&#34; }&#39;</span> http://<span style="color:#e6db74">${</span>INGRESS_ADDRESS<span style="color:#e6db74">}</span>/v1/damage; <span style="color:#66d9ef">done</span></span></span></code></pre></div></p>
<p>
<img src="istio-1.png" alt="istio-1.png" title="istio-1.png" /></p>
<p>
This is a good example of your services flow, after you can track your request via opentracing and Zipkin:</p>
<p>
<img src="istio-2.png" alt="istio-2.png" title="istio-2.png" /></p>
<p>
Or you can check out both services usage on Grafana, the metrics are grabbed automatically.</p>
<p>
<img src="istio-5.png" alt="istio-5.png" title="istio-5.png" />
<img src="istio-3.png" alt="istio-3.png" title="istio-3.png" /></p>
</div>
</div>
<div id="outline-container-headline-23" class="outline-4">
<h4 id="headline-23">
Custom HTTP metric
</h4>
<div id="outline-text-headline-23" class="outline-text-4">
<p>
This new metric will increment a counter each time the endpoint is called with analytic=true. To enable the counter run the following command inside the project repo, and call the endpoint with the parameter.</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>make set-metric
</span></span><span style="display:flex;"><span>$ curl ... http://<span style="color:#e6db74">${</span>INGRESS_ADDRESS<span style="color:#e6db74">}</span>/v1/damage?analytic<span style="color:#f92672">=</span>true</span></span></code></pre></div></p>
<p>
The rule will be applied after the match filter and the prometheus adapter being used.</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#e6db74">&#34;config.istio.io/v1alpha2&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">rule</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">analyticprom</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">istio-system</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">match</span>: <span style="color:#ae81ff">match(request.path, &#34;/v1/damage?analytic=*&#34;)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">actions</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">handler</span>: <span style="color:#ae81ff">promhandler.prometheus</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">instances</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">analyticcounter.metric</span></span></span></code></pre></div></p>
<p>
You can create new Grafana visualizations in the dashboard from Prometheus metrics.</p>
<p>
<img src="istio-4.png" alt="istio-4.png" title="istio-4.png" /></p>
</div>
</div>
<div id="outline-container-headline-24" class="outline-4">
<h4 id="headline-24">
Playing around with Mixer adapter
</h4>
<div id="outline-text-headline-24" class="outline-text-4">
<p>
 For those curious about the mixer usage here goes a plugin to send metrics to Librato.</p>
<p>
 <a href="https://github.com/knabben/librato-adapter">https://github.com/knabben/librato-adapter</a></p>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-25" class="outline-3">
<h3 id="headline-25">
Reference
</h3>
<div id="outline-text-headline-25" class="outline-text-3">
<div id="outline-container-headline-26" class="outline-5">
<h5 id="headline-26">
[1] <a href="https://github.com/kelseyhightower/kubernetes-the-hard-way">https://github.com/kelseyhightower/kubernetes-the-hard-way</a>
</h5>
</div>
<div id="outline-container-headline-27" class="outline-5">
<h5 id="headline-27">
[2] <a href="http://blog.christianposta.com/istio-workshop/slides/#/title">http://blog.christianposta.com/istio-workshop/slides/#/title</a>
</h5>
</div>
<div id="outline-container-headline-28" class="outline-5">
<h5 id="headline-28">
[3] <a href="https://github.com/knabben/grpc-ex">https://github.com/knabben/grpc-ex</a>
</h5>
</div>
<div id="outline-container-headline-29" class="outline-5">
<h5 id="headline-29">
[4] <a href="https://istio.io/docs/setup/kubernetes/quick-start-gke-dm.html">https://istio.io/docs/setup/kubernetes/quick-start-gke-dm.html</a>
</h5>
</div>
<div id="outline-container-headline-30" class="outline-5">
<h5 id="headline-30">
[5] <a href="https://istio.io/docs/setup/kubernetes/sidecar-injection.html#automatic-sidecar-injection">https://istio.io/docs/setup/kubernetes/sidecar-injection.html#automatic-sidecar-injection</a>
</h5>
</div>
</div>
</div>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/2018/0527/langs1/" title="Bootstraping languages"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/2018/0325/" title="Technical indicators" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1755015469"></script>
    <script src="/js/perfect-scrollbar.min.js?1755015469"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1755015469"></script>
    <script src="/js/jquery.sticky.js?1755015469"></script>
    <script src="/js/featherlight.min.js?1755015469"></script>
    <script src="/js/highlight.pack.js?1755015469"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1755015469"></script>
    <script src="/js/learn.js?1755015469"></script>
    <script src="/js/hugo-learn.js?1755015469"></script>
    
        
            <script src="/mermaid/mermaid.js?1755015469"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

