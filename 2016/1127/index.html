<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.113.0">
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Continuous Deployment and DEIS :: compulsory thinking</title>

    
    <link href="/css/nucleus.css?1755014861" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1755014861" rel="stylesheet">
    <link href="/css/hybrid.css?1755014861" rel="stylesheet">
    <link href="/css/featherlight.min.css?1755014861" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1755014861" rel="stylesheet">
    <link href="/css/auto-complete.css?1755014861" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1755014861" rel="stylesheet">
    <link href="/css/theme.css?1755014861" rel="stylesheet">
    <link href="/css/tabs.css?1755014861" rel="stylesheet">
    <link href="/css/hugo-theme.css?1755014861" rel="stylesheet">
    
    <link href="/css/theme-blue.css?1755014861" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1755014861"></script>
      
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SXHZPRXGDZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-SXHZPRXGDZ');
    </script>
    <script>
    if (location.host.indexOf("localhost") < 0 && location.protocol !== "https:") {
      location.protocol = "https:";
    }
    </script>
    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/2016/1127/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='/'>
  עֹז
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1755014861"></script>
<script type="text/javascript" src="/js/auto-complete.js?1755014861"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/opssec.in\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1755014861"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/2025/" title="2025" class="dd-item
        
        
        
        ">
      <a href="/2025/">
          2025
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/2025/0812/" title="Embracing Vibe Ops: AI-Driven Troubleshooting for ClusterAPI" class="dd-item
        
        
        
        ">
      <a href="/2025/0812/">
          Embracing Vibe Ops: AI-Driven Troubleshooting for ClusterAPI
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2024/" title="2024" class="dd-item
        
        
        
        ">
      <a href="/2024/">
          2024
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/2024/0201/" title="Kubernetes vSphere CSI on Windows" class="dd-item
        
        
        
        ">
      <a href="/2024/0201/">
          Kubernetes vSphere CSI on Windows
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2024/0104/" title="Kubernetes Windows Nodes" class="dd-item
        
        
        
        ">
      <a href="/2024/0104/">
          Kubernetes Windows Nodes
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2023/" title="2023" class="dd-item
        
        
        
        ">
      <a href="/2023/">
          2023
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/2023/1230/" title="Running Windows cluster locally" class="dd-item
        
        
        
        ">
      <a href="/2023/1230/">
          Running Windows cluster locally
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0801/" title="sigstore policy-controller validation" class="dd-item
        
        
        
        ">
      <a href="/2023/0801/">
          sigstore policy-controller validation
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0721/" title="Ztunnel SPIRE implementation" class="dd-item
        
        
        
        ">
      <a href="/2023/0721/">
          Ztunnel SPIRE implementation
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0702/" title="Waypoint Proxy for the app layer" class="dd-item
        
        
        
        ">
      <a href="/2023/0702/">
          Waypoint Proxy for the app layer
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0630/" title="Ztunnel on Ambient Mesh" class="dd-item
        
        
        
        ">
      <a href="/2023/0630/">
          Ztunnel on Ambient Mesh
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0628/" title="Istio CNI on Ambient Mesh" class="dd-item
        
        
        
        ">
      <a href="/2023/0628/">
          Istio CNI on Ambient Mesh
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0622/" title="Istio Ambient Service Mesh Demo" class="dd-item
        
        
        
        ">
      <a href="/2023/0622/">
          Istio Ambient Service Mesh Demo
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0611/" title="SPIFFE/SPIRE for gRPC authz" class="dd-item
        
        
        
        ">
      <a href="/2023/0611/">
          SPIFFE/SPIRE for gRPC authz
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0608/" title="Secure gRPC services with mTLS" class="dd-item
        
        
        
        ">
      <a href="/2023/0608/">
          Secure gRPC services with mTLS
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0406/" title="Windows CNI tracing and deep dive" class="dd-item
        
        
        
        ">
      <a href="/2023/0406/">
          Windows CNI tracing and deep dive
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0330/" title="Windows Containers and .NET apps" class="dd-item
        
        
        
        ">
      <a href="/2023/0330/">
          Windows Containers and .NET apps
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2023/0322/" title="Multi AZ on Kubernetes and vSphere" class="dd-item
        
        
        
        ">
      <a href="/2023/0322/">
          Multi AZ on Kubernetes and vSphere
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2022/" title="2022" class="dd-item
        
        
        
        ">
      <a href="/2022/">
          2022
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/2022/0712/" title="Hybrid nodes with ClusterClass on Amazon Web Service" class="dd-item
        
        
        
        ">
      <a href="/2022/0712/">
          Hybrid nodes with ClusterClass on Amazon Web Service
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2022/0610/" title="Border Gateway Protocol (BGP) and Kubernetes" class="dd-item
        
        
        
        ">
      <a href="/2022/0610/">
          Border Gateway Protocol (BGP) and Kubernetes
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2022/0320/" title="Cluster API Provider for Azure" class="dd-item
        
        
        
        ">
      <a href="/2022/0320/">
          Cluster API Provider for Azure
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2022/0122/" title="Kube-Proxy Next Gen Windows Userspace" class="dd-item
        
        
        
        ">
      <a href="/2022/0122/">
          Kube-Proxy Next Gen Windows Userspace
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2021/" title="2021" class="dd-item
        
        
        
        ">
      <a href="/2021/">
          2021
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/2021/1218/" title="Kube-proxy Windows Kernelspace Mode" class="dd-item
        
        
        
        ">
      <a href="/2021/1218/">
          Kube-proxy Windows Kernelspace Mode
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/1127/" title="Kube-proxy Linux Userspace Mode" class="dd-item
        
        
        
        ">
      <a href="/2021/1127/">
          Kube-proxy Linux Userspace Mode
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/1017/" title="Kube-proxy Winuserspace Mode" class="dd-item
        
        
        
        ">
      <a href="/2021/1017/">
          Kube-proxy Winuserspace Mode
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/0903/" title="Windows and Calico overlay networking" class="dd-item
        
        
        
        ">
      <a href="/2021/0903/">
          Windows and Calico overlay networking
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/0828/" title="CNI plugins and kindnet" class="dd-item
        
        
        
        ">
      <a href="/2021/0828/">
          CNI plugins and kindnet
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/0614/" title="Kube-proxy ClusterIP" class="dd-item
        
        
        
        ">
      <a href="/2021/0614/">
          Kube-proxy ClusterIP
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2021/0228/" title="Kubernetes Windows Nodes" class="dd-item
        
        
        
        ">
      <a href="/2021/0228/">
          Kubernetes Windows Nodes
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2020/" title="2020" class="dd-item
        
        
        
        ">
      <a href="/2020/">
          2020
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2020/1227/" title="Network Policy E2E test suite" class="dd-item ">
        <a href="/2020/1227/">
        Network Policy E2E test suite
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2020/2405/" title="Kubelet Dynamic Configuration" class="dd-item ">
        <a href="/2020/2405/">
        Kubelet Dynamic Configuration
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2020/1005/" title="Kubelet Debugging Session" class="dd-item ">
        <a href="/2020/1005/">
        Kubelet Debugging Session
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2019/" title="2019" class="dd-item
        
        
        
        ">
      <a href="/2019/">
          2019
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2019/1228/" title="Kubernetes Networking 101" class="dd-item ">
        <a href="/2019/1228/">
        Kubernetes Networking 101
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/12282/" title="Kubernetes Deployment Workloads" class="dd-item ">
        <a href="/2019/12282/">
        Kubernetes Deployment Workloads
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/12283/" title="Kubernetes Container API" class="dd-item ">
        <a href="/2019/12283/">
        Kubernetes Container API
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1227/" title="Pod specification" class="dd-item ">
        <a href="/2019/1227/">
        Pod specification
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1226/" title="Kubectl Walkthrough" class="dd-item ">
        <a href="/2019/1226/">
        Kubectl Walkthrough
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1225/" title="Kubernetes in Docker" class="dd-item ">
        <a href="/2019/1225/">
        Kubernetes in Docker
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1215/" title="Sawtooth Cheatsheet" class="dd-item ">
        <a href="/2019/1215/">
        Sawtooth Cheatsheet
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1208/" title="Sawtooth Permissioning" class="dd-item ">
        <a href="/2019/1208/">
        Sawtooth Permissioning
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1127/" title="Kubernetes Audit Sink" class="dd-item ">
        <a href="/2019/1127/">
        Kubernetes Audit Sink
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1123/" title="Kubernetes API client" class="dd-item ">
        <a href="/2019/1123/">
        Kubernetes API client
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/11161/dev-poet/" title="From Dev to PoET" class="dd-item ">
        <a href="/2019/11161/dev-poet/">
        From Dev to PoET
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1116/" title="Sawtooth Network Monitoring" class="dd-item ">
        <a href="/2019/1116/">
        Sawtooth Network Monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2019/1111/" title="Gossip networks" class="dd-item ">
        <a href="/2019/1111/">
        Gossip networks
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2018/" title="2018" class="dd-item
        
        
        
        ">
      <a href="/2018/">
          2018
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2018/08072/" title="Golang essays (part II)" class="dd-item ">
        <a href="/2018/08072/">
        Golang essays (part II)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0807/" title="Golang essays (part I)" class="dd-item ">
        <a href="/2018/0807/">
        Golang essays (part I)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0704/langs2/" title="Rust 101" class="dd-item ">
        <a href="/2018/0704/langs2/">
        Rust 101
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0602/sawtooth/" title="Hyperledger Sawtooth" class="dd-item ">
        <a href="/2018/0602/sawtooth/">
        Hyperledger Sawtooth
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0527/langs1/" title="Bootstraping languages" class="dd-item ">
        <a href="/2018/0527/langs1/">
        Bootstraping languages
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0806/" title="Service Mesh" class="dd-item ">
        <a href="/2018/0806/">
        Service Mesh
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2018/0325/" title="Technical indicators" class="dd-item ">
        <a href="/2018/0325/">
        Technical indicators
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2017/" title="2017" class="dd-item
        
        
        
        ">
      <a href="/2017/">
          2017
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2017/1012/" title="More statistics and Python" class="dd-item ">
        <a href="/2017/1012/">
        More statistics and Python
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2017/0701/" title="Probability" class="dd-item ">
        <a href="/2017/0701/">
        Probability
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2017/0625/" title="Statistics and Python" class="dd-item ">
        <a href="/2017/0625/">
        Statistics and Python
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2016/" title="2016" class="dd-item
        parent
        
        
        ">
      <a href="/2016/">
          2016
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2016/1216/apk/" title="Android APK hacking" class="dd-item ">
        <a href="/2016/1216/apk/">
        Android APK hacking
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2016/1127/" title="Continuous Deployment and DEIS" class="dd-item active">
        <a href="/2016/1127/">
        Continuous Deployment and DEIS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2016/0618/ecto/" title="Ecto vs. Django ORM" class="dd-item ">
        <a href="/2016/0618/ecto/">
        Ecto vs. Django ORM
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2016/0416/cpython/" title="CPython Debugging" class="dd-item ">
        <a href="/2016/0416/cpython/">
        CPython Debugging
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2016/0123/" title="Golang vs. Python" class="dd-item ">
        <a href="/2016/0123/">
        Golang vs. Python
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2016/0116/" title="Monitoring MySQL w/ Prometheus" class="dd-item ">
        <a href="/2016/0116/">
        Monitoring MySQL w/ Prometheus
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2015/" title="2015" class="dd-item
        
        
        
        ">
      <a href="/2015/">
          2015
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/2015/0309/consul/" title="Consul - Service Discovery" class="dd-item ">
        <a href="/2015/0309/consul/">
        Consul - Service Discovery
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2015/0908/finance/" title="General finance formulas" class="dd-item ">
        <a href="/2015/0908/finance/">
        General finance formulas
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/2015/2607/" title="Tsung Capacity Test" class="dd-item ">
        <a href="/2015/2607/">
        Tsung Capacity Test
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      <center>
  <p><b>Amim Knabben</b> - 2024</p>
    amim.knabben@gmail.com
  <br/>
  <a href="https://github.com/knabben"><i class="fab fa-github"></i></a>
  <a href="https://twitter.com/ak_ndb"><i class="fab fa-twitter"></i></a>
  <a href="https://linkedin.com/in/amim"><i class="fab fa-linkedin"></i></a>
  <br />
  <br />

  <a href="https://md.opssec.in">win32 API </i></a>

</center>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'></a> > <a href='/2016/'>2016</a> > Continuous Deployment and DEIS
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li><a href="#headline-1">Introduction</a>
</li>
<li><a href="#headline-2">Deployment Pipeline</a>
</li>
<li><a href="#headline-3">Configuration Management</a>
</li>
<li><a href="#headline-4">Continuous Integration</a>
</li>
<li><a href="#headline-5">Deployment of modern apps</a>
</li>
<li><a href="#headline-6">DEIS and concrete processes</a>
</li>
<li><a href="#headline-7">Settings up the Kubernetes Cluster</a>
</li>
<li><a href="#headline-8">Build, Release, Run</a>
</li>
<li><a href="#headline-9">DEIS register</a>
</li>
<li><a href="#headline-10">DEIS and the apps</a>
</li>
<li><a href="#headline-11">Builder and slugs</a>
</li>
<li><a href="#headline-12">Back to the controller</a>
</li>
<li><a href="#headline-13">3rd party integration</a>
</li>
<li><a href="#headline-14">HELM</a>
</li>
<li><a href="#headline-15">Conclusion</a>
</li>
<li><a href="#headline-16">Reference</a>
<ul>
<li><a href="#headline-17">[1] https://www.amazon.com/Continuous-Delivery-Deployment-Automation-Addison-Wesley/dp/0321601912/183-9249231-2275620?ie=UTF8&amp;redirect=true</a>
</li>
<li><a href="#headline-18">[2] Building Microservices</a>
</li>
<li><a href="#headline-19">[3] https://www.cloudbees.com/continuous-delivery/jenkins-docker</a>
</li>
<li><a href="#headline-20">[4] http://deis.com/workflow/</a>
</li>
<li><a href="#headline-21">[5] https://deis.com/docs/workflow/understanding-workflow/concepts/#build-release-run</a>
</li>
<li><a href="#headline-22">[6] https://github.com/deis/builder</a>
</li>
<li><a href="#headline-23">[7] https://github.com/olalonde/deisdash</a>
</li>
<li><a href="#headline-24">[8] http://helm.sh</a>
</li>
<li><a href="#headline-25">[9] https://github.com/kubernetes/community/tree/master/sig-apps</a>
</li>
</ul>
</li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Continuous Deployment and DEIS
            </h1>
          

        



<div id="outline-container-headline-1" class="outline-3">
<h3 id="headline-1">
Introduction
</h3>
<div id="outline-text-headline-1" class="outline-text-3">
<p>
Continuous Deployment and Continuous Integration are topics that you can evolve and improve forever. The best reading on it IMO is [1] by Jez Humble, and it will be the guide for this post.</p>
<p>
&#34;The time from deciding that you need to make a change to having it in production is known as the cycle time, and it is a vital metric for any project.&#34;</p>
<p>
What we want here is do reduce the cycle time of the project in a reliable, secure and low-risk way, an automated process that is trusted enough to not be rolledback.</p>
<p>
It means you are going to need a good deployment pipeline with lots of software testing before making the shine feature in production.</p>
<p>
Some other stuff counts here like metrics visibility, easy triggers to start the process, etc.</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-3">
<h3 id="headline-2">
Deployment Pipeline
</h3>
<div id="outline-text-headline-2" class="outline-text-3">
<ol>
<li>Commit stage - This stage normally is holded by a CI process, it creates the artifact, to be used by the pipeline.</li>
<li>Automated Acceptance testing - You should have a staging environment for this kind of tests, it means you must create an environment equals your production to run it.</li>
<li>Automated capacity testing - The same env is used here, you can use tools like Tsung, jmeter.</li>
<li>Manual testing (exploratory) - So it expects that you have your last step, to find bugs navigating on the system.</li>
<li>Release - Deploy it!</li>
</ol>
<p>&#34;Automation is the key. It allows all of the common tasks involved in the creation and deployment of software to be performed by developers, testers, and operations personnel, at the push of a button.</p>
<p>
When deployments aren’t fully automated, errors will occur every time they are performed. The only question is whether or not the errors are significant. Even with excellent deployment tests, bugs can be hard to track down. When the deployment process is not automated, it is not repeatable or reliable, leading to time wasted on debugging deployment errors.&#34;</p>
<p>
Again speed here counts because you cannot make money without the feature or bugfix in production.</p>
<p>
Every change (or commit) should trigger the pipeline, the artifact resulted from the CI pipeline should be tested before going to the release.</p>
<p>
The principal benefit of the approach that we describe in the preceding section is that it creates a release process that is repeatable, reliable, and predictable, which in turn generates large reductions in cycle time, and hence gets features and bugfixes to users fast. The cost savings alone are worth not just the cover price of this book, but also the investment in time that the establishment and maintenance of such a release system entails.</p>
<p>
The best advise of the book: If It Hurts, Do It More Frequently, and Bring the Pain Forward.</p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-3">
<h3 id="headline-3">
Configuration Management
</h3>
<div id="outline-text-headline-3" class="outline-text-3">
<p>
It is the way you have a baseline for your servers, how you have the certainty that package X is installed or removed from your system, that the service Y will be UP. It is how you mantain a initial state for you OS in an automated way. We have a lot of CM systems out there: Ansible, Puppet, Chef…</p>
<p>
With the tools borned the concept of IaC (infrastructure as a code), you now can model your infrastructure assets in a dependendable fashion, in any environment (bare-metal, private/public cloud), and make sure all boxes remains the same.</p>
<p>
To make sure you have this implemented Jez makes a good question: Can you be sure that each deployed environment in production, in stagin and in test is set up in precisely same way? Could you regress to an earlier know good state of your app?</p>
</div>
</div>
<div id="outline-container-headline-4" class="outline-3">
<h3 id="headline-4">
Continuous Integration
</h3>
<div id="outline-text-headline-4" class="outline-text-3">
<p>
The goal of CI is to keep everyone in sync with each other, which we achieve by making sure that newly checked-in code propery integrates with existing code. [2]</p>
<p>
Here you can use tools like TravisCI or Jenkins to merge your fix branches on the master, run all unit tests and create the artifact from it. The trick here is process feedbacks, it is the first part of the pipeline and if you have it very concrete it should be the base to the rest.</p>
</div>
</div>
<div id="outline-container-headline-5" class="outline-3">
<h3 id="headline-5">
Deployment of modern apps
</h3>
<div id="outline-text-headline-5" class="outline-text-3">
<p>
When the book were wrote Docker, (2013) didn&#39;t existed yet, even the 12-factor methodology (2012), so things in this field are VERY new, as the concept of microservices as well.</p>
<p>
People are still discovering and adapting how these processes can work with these new technology. A good example is Deis: a lightweight application platform that deploys and scales 12-factor apps as Docker and containers across a cluster of CoreOS machines.</p>
<p>
So to resume: the 12-factor methodology is a composition of the best practices from the CI/CD process for modern application and Deis uses great technologies like CoreOS and Docker to make it practical, on other posts we will analyze how it is implemented.</p>
<p>
As stated on Chapter 6 of Building Microservices, deploying a monolithic app is a fairly straighforward process. Microservices, with their interdependence, are a different kettle of fish altogether. If you don&#39;t approach deployment right, it&#39;s one of those areas where the complexity can make your life a misery.</p>
</div>
</div>
<div id="outline-container-headline-6" class="outline-3">
<h3 id="headline-6">
DEIS and concrete processes
</h3>
<div id="outline-text-headline-6" class="outline-text-3">
<p>
Make CI/CD systems well integrated with your infrastructure is a complex task, things get worse when these systems must be modularized and easy to adapt to your deploy pipeline. You have a lot of rowing up applications with different requirements, code and ways to run. This layer on top of your infrastructure is now known as PaaS, Heroku is a great example of how you can abstract the complexity of running a new app in 2 or 3 commands. It should be awesome to have the same capability on your hands and control of the stack, this way you can modify or replace pieces in a transparent way. For the company they probably will have to worry about the total cost of ownership and good people to manage it.</p>
<p>
Some examples of opensource software in the market to achieve it: Jenkins Pipeline and the guys from CloudBee [1] made a good job with it, you can run slaves as Kubernetes pods for example, and create stages in a very dynamic way for your pipeline.</p>
<p>
DEIS workflow and its microserviced architecture [2]: a Heroku SDK for Kubernetes, they have very detailed documentation worth to read, I am going to explain the general parts on this article.</p>
<p>
The guys from DEIS have other project pretty much interesting called HELM, it is much more simple than Deis Workflow, think of it as a package manager for Kubernetes.</p>
</div>
</div>
<div id="outline-container-headline-7" class="outline-3">
<h3 id="headline-7">
Settings up the Kubernetes Cluster
</h3>
<div id="outline-text-headline-7" class="outline-text-3">
<p>
We are using the &#34;new&#34; kubeadm tool to setup the cluster on a Debian machines for development, take a look on the documentation but you can run this script to have it up:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Remove old kubeadm stuff</span>
</span></span><span style="display:flex;"><span>kubeadm reset
</span></span><span style="display:flex;"><span>systemctl restart kubelet
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>kubeadm init
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f /etc/kubernetes/kubelet.conf <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>	export KUBECONFIG<span style="color:#f92672">=</span>/etc/kubernetes/kubelet.conf
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create pod network</span>
</span></span><span style="display:flex;"><span>kubectl apply -f https://git.io/weave-kube
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Enable pods start</span>
</span></span><span style="display:flex;"><span>kubectl taint nodes --all dedicated-</span></span></code></pre></div></p>
<p>
So far so good, you have a bunch of docker containers check it with ps or try to run a new &#39;kubectl run nginx –image=nginx&#39;</p>
<p>
We can start Deis with the following helmc script:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ helmc generate workflow-v2.8.0
</span></span><span style="display:flex;"><span>$ helmc install workflow-v2.8.0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NAME                                     READY     STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>deis-builder-415246326-97ioi             1/1       Running   <span style="color:#ae81ff">13</span>         15h
</span></span><span style="display:flex;"><span>deis-controller-1590631305-rqev9         1/1       Running   <span style="color:#ae81ff">13</span>         15h
</span></span><span style="display:flex;"><span>deis-database-510315365-3oro8            1/1       Running   <span style="color:#ae81ff">7</span>          15h
</span></span><span style="display:flex;"><span>deis-logger-9212198-n38h8                1/1       Running   <span style="color:#ae81ff">17</span>         15h
</span></span><span style="display:flex;"><span>deis-logger-fluentd-mny1o                1/1       Running   <span style="color:#ae81ff">4</span>          15h
</span></span><span style="display:flex;"><span>deis-logger-redis-663064164-jm8fx        1/1       Running   <span style="color:#ae81ff">4</span>          15h
</span></span><span style="display:flex;"><span>deis-minio-3160338312-oxhp9              1/1       Running   <span style="color:#ae81ff">4</span>          15h
</span></span><span style="display:flex;"><span>deis-monitor-grafana-432364990-fieg8     1/1       Running   <span style="color:#ae81ff">4</span>          15h
</span></span><span style="display:flex;"><span>deis-monitor-influxdb-2729526471-d7v66   1/1       Running   <span style="color:#ae81ff">4</span>          15h
</span></span><span style="display:flex;"><span>deis-monitor-telegraf-d3gva              1/1       Running   <span style="color:#ae81ff">14</span>         15h
</span></span><span style="display:flex;"><span>deis-nsqd-3264449345-inu6p               1/1       Running   <span style="color:#ae81ff">4</span>          15h
</span></span><span style="display:flex;"><span>deis-registry-2182132043-5go81           1/1       Running   <span style="color:#ae81ff">14</span>         15h
</span></span><span style="display:flex;"><span>deis-registry-proxy-s6aph                1/1       Running   <span style="color:#ae81ff">4</span>          15h
</span></span><span style="display:flex;"><span>deis-router-2457652422-tznjt             1/1       Running   <span style="color:#ae81ff">6</span>          15h
</span></span><span style="display:flex;"><span>deis-workflow-manager-2210821749-4lqkp   1/1       Running   <span style="color:#ae81ff">4</span>          15h</span></span></code></pre></div></p>
</div>
</div>
<div id="outline-container-headline-8" class="outline-3">
<h3 id="headline-8">
Build, Release, Run
</h3>
<div id="outline-text-headline-8" class="outline-text-3">
<p>
Take a look on [3], you can see the flow diagram of how DEIS workflow behaves, and provide to the developer a simple interface for deployments. </p>
<p>
The principal idea here is a release. One of the problems faced with raw kubernetes deployments is when you have to update/change your mounted secret on an environemnt variable, it doesn&#39;t reflect direct on your pod, so you have to restart or redeploy it manually. With DEIS a release can be a code change or a configuration change, if one of these change a new release is deployed.</p>
<p>
Basically DEIS workflow have a gitserver with some hooks (&#34;git-receive-pack&#34;, &#34;git-upload-pack&#34;), after you push your git repo to the system, the system detects your build type (dockerbuild or slugbuilds) and create a new pod that builds the artifact, DEIS controller in the end will start a deployment object on your Kubernetes cluster.</p>
</div>
</div>
<div id="outline-container-headline-9" class="outline-3">
<h3 id="headline-9">
DEIS register
</h3>
<div id="outline-text-headline-9" class="outline-text-3">
<p>
The operator frontend is a command line called &#34;deis&#34;. On deis/workflow-cli repo, exists a folder called cmd, on auth.go we find the Register func, these files are more a wrapper and the initial glue for the logic business, deis/controller-skd-go has the sdk. IF you follow the stack via auth.go:64 you hit controller-sdk.go auth.Register it calls &#34;<em>v2/auth/register</em>&#34; on your controller.</p>
<p>
First of all we need to find the router IP service via &#34;kubectl –namespace=deis describe svc deis-router&#34;, and use it to call the register command: &#34;deis register <a href="http://deis.10.6.40.159.nip.io">http://deis.10.6.40.159.nip.io</a>&#34;.</p>
<p>
If you start your domain with the app name like: app.10.6.40.19.nip.io, workflow router will handle it and route to your application. DEIS will label router.deis.io/routable: &#34;true&#34; on each service you want to route packets to.</p>
<p>
Going back to the register namespace on the controller, we have a Django (Rest Framework) app with a PostgreSQL database, that stores all configurations. </p>
<p>
It is possible to replace parts of your cluster for a development one in a few &#34;make deploy&#34; command. Or you can customize it on the Helm Classic installation.</p>
</div>
</div>
<div id="outline-container-headline-10" class="outline-3">
<h3 id="headline-10">
DEIS and the apps
</h3>
<div id="outline-text-headline-10" class="outline-text-3">
<p>
Going through the flow we find the create command, again take a look on AppCreate and controller-sdk-go/apps, func New, here it makes a POST on Django <em>v2/apps</em> it basically create a new api_apps row on PostgreSQL db. With the app created you can start releases and set other configurations.</p>
<p>
After register a new user and login the system, you have to put your publickey on DEIS to be able to push code.</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>deis keys:add ~/.key.pub</span></span></code></pre></div></p>
<p>
When you create a new app (deis create yourapp), a remote git repository will be created and point to your builder host (port 2222). All you need to do is push your local repo to the remote:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>git push origin deis</span></span></code></pre></div></p>
</div>
</div>
<div id="outline-container-headline-11" class="outline-3">
<h3 id="headline-11">
Builder and slugs
</h3>
<div id="outline-text-headline-11" class="outline-text-3">
<p>
DEIS Builder will handle your request and based on the server hooks start the builder pod, suppose we are using a Dockerfile commited on the project, lets take a look on the dockerbuild file:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The .tar.gz file artifact is fetched from the Builder Storage</span>
</span></span><span style="display:flex;"><span>with tarfile.open<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;apptar&#34;</span>, <span style="color:#e6db74">&#34;r:gz&#34;</span><span style="color:#f92672">)</span> as tar:
</span></span><span style="display:flex;"><span>    tar.extractall<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/app/&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Use docker api to build and push docker to registry</span>
</span></span><span style="display:flex;"><span>client <span style="color:#f92672">=</span> docker.Client<span style="color:#f92672">(</span>version<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;auto&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>registry <span style="color:#f92672">=</span> get_registry_name<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>imageName, imageTag <span style="color:#f92672">=</span> os.getenv<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;IMG_NAME&#39;</span><span style="color:#f92672">)</span>.split<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;:&#34;</span>, 1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>repo <span style="color:#f92672">=</span> registry + <span style="color:#e6db74">&#34;/&#34;</span> + os.getenv<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;IMG_NAME&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>stream <span style="color:#f92672">=</span> client.build<span style="color:#f92672">(</span>tag<span style="color:#f92672">=</span>repo, stream<span style="color:#f92672">=</span>True, decode<span style="color:#f92672">=</span>True, rm<span style="color:#f92672">=</span>True, pull<span style="color:#f92672">=</span>True, path<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;/app&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>log_output<span style="color:#f92672">(</span>stream, True<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Pushing to registry&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>stream <span style="color:#f92672">=</span> client.push<span style="color:#f92672">(</span>registry+<span style="color:#e6db74">&#39;/&#39;</span>+imageName, tag<span style="color:#f92672">=</span>imageTag, stream<span style="color:#f92672">=</span>True<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div></p>
<p>
PS: In production I really recommend to use ECR (external docker repository) and an external artifacts storage, take a look on ~/.helmc/workflow/charts/workflow-v2.8.0/tpl/generate_params.toml, otherwise you can full your disk very fast:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>storage <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;s3&#34;</span>
</span></span><span style="display:flex;"><span>repository_location <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ecr&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>ecr<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>region <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;us-east-1&#34;</span>
</span></span><span style="display:flex;"><span>hostname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;...ecr.us-east-1.amazonaws.com&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>s3<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>registry_bucket <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;deisregistry&#34;</span>  <span style="color:#75715e"># Docker Registry</span>
</span></span><span style="display:flex;"><span>database_bucket <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;deisdb&#34;</span>  <span style="color:#75715e"># PGSql backups</span>
</span></span><span style="display:flex;"><span>builder_bucket <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;deisbuild&#34;</span>  <span style="color:#75715e"># Artifacts</span></span></span></code></pre></div></p>
<p>
PS2: You can have a similar JOB on jenkins pipeline, something like:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>node <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	stage <span style="color:#e6db74">&#39;login&#39;</span>
</span></span><span style="display:flex;"><span>	sh <span style="color:#e6db74">&#39;$(aws ecr get-login)&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    stage <span style="color:#e6db74">&#39;git&#39;</span>
</span></span><span style="display:flex;"><span>	dir<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;project&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		git credentialsId: <span style="color:#e6db74">&#39;xxx&#39;</span>, url: <span style="color:#e6db74">&#39;git@github.com:comp/proj&#39;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	stage <span style="color:#e6db74">&#39;build_push&#39;</span>
</span></span><span style="display:flex;"><span>	docker.withRegistry<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;http://..us-east-1.amazonaws.com&#39;</span>, <span style="color:#e6db74">&#39;proj&#39;</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		def proj <span style="color:#f92672">=</span> docker.build<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;proj:</span><span style="color:#e6db74">${</span>env.BUILD_NUMBER<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;.&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>		proj.push<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div></p>
<p>
I have the artifact and now? Step back and ask again: I have the artifact, how? The answer is the func build on pkg/gitreceive/build.go, it started the build pod watched it run outputed the logs and launched it with hook.CreateBuild, here we came back again to the controller pod c.Request(&#34;POST&#34;, &#34;<em>v2/hooks/build</em>&#34;, b), can you see what da heck if microservices?</p>
</div>
</div>
<div id="outline-container-headline-12" class="outline-3">
<h3 id="headline-12">
Back to the controller
</h3>
<div id="outline-text-headline-12" class="outline-text-3">
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>urls<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>url(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;^hooks/build/?$&#39;</span>, views<span style="color:#f92672">.</span>BuildHookViewSet<span style="color:#f92672">.</span>as_view({<span style="color:#e6db74">&#39;post&#39;</span>: <span style="color:#e6db74">&#39;create&#39;</span>})),
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>To resume the stack<span style="color:#f92672">-</span> <span style="color:#f92672">&gt;</span> BuildHookViewSet <span style="color:#f92672">-&gt;</span> starts a new Build object <span style="color:#f92672">and</span> <span style="color:#66d9ef">with</span> a post_save signal starts a new release <span style="color:#66d9ef">with</span> models<span style="color:#f92672">/</span>build<span style="color:#f92672">.</span>py:<span style="color:#ae81ff">65</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>self<span style="color:#f92672">.</span>app<span style="color:#f92672">.</span>deploy(new_release)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>models<span style="color:#f92672">/</span>app<span style="color:#f92672">.</span>py:<span style="color:#ae81ff">446</span> <span style="color:#66d9ef">as</span> a FK of the build<span style="color:#f92672">.</span> lets deploy a new revision of the app<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tasks <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>	functools<span style="color:#f92672">.</span>partial(
</span></span><span style="display:flex;"><span>		self<span style="color:#f92672">.</span>_scheduler<span style="color:#f92672">.</span>deploy,
</span></span><span style="display:flex;"><span>		namespace<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>id,
</span></span><span style="display:flex;"><span>		name<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>_get_job_id(scale_type),
</span></span><span style="display:flex;"><span>		image<span style="color:#f92672">=</span>image,
</span></span><span style="display:flex;"><span>		entrypoint<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>_get_entrypoint(scale_type),
</span></span><span style="display:flex;"><span>		command<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>_get_command(scale_type),
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">**</span>kwargs
</span></span><span style="display:flex;"><span>	) <span style="color:#66d9ef">for</span> scale_type, kwargs <span style="color:#f92672">in</span> deploys<span style="color:#f92672">.</span>items()
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>async_run(tasks)  <span style="color:#75715e"># Just a bunch of asyncio threads</span></span></span></code></pre></div></p>
<p>
The _scheduler object here looks interesting, the AuditModel (parent of App) do importlib.import_module(settings.SCHEDULER_MODULE) on scheduler property, the scheduler module starts the KubeHTTPClient and the deploy creates/update a deployment Kubernetes via REST API with some custom data.</p>
</div>
</div>
<div id="outline-container-headline-13" class="outline-3">
<h3 id="headline-13">
3rd party integration
</h3>
<div id="outline-text-headline-13" class="outline-text-3">
<p>
A dashboard [5] can be useful for log analysis for example, DEIS comes integrated with fluentd for log and grafana + influxdb for metrics and monitoring.</p>
</div>
</div>
<div id="outline-container-headline-14" class="outline-3">
<h3 id="headline-14">
HELM
</h3>
<div id="outline-text-headline-14" class="outline-text-3">
<p>
Helm 2.0 [6] is Kubernetes package manager build by DEIS, you can find some ready Charts, kudos to the Jenkins one:</p>
<p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>helm install stable/jenkins</span></span></code></pre></div></p>
<p>
You can start your own helm with create and manage the deployments with upgrade, releases and etc. Another good project on top of kubernetes to keep the eye on.</p>
</div>
</div>
<div id="outline-container-headline-15" class="outline-3">
<h3 id="headline-15">
Conclusion
</h3>
<div id="outline-text-headline-15" class="outline-text-3">
<p>
DEIS Workflow provides a very cool PaaS environment for the end lazy developer, normally peopl don&#39;t give a shit about the stack behind their code, and just want to run it. So DEIS is the option with some custom configuration and an extended dashboard you can provide a good self-service model of deployment.</p>
<p>
HELM is a Kubernetes package manager, a bunch of templates with custom configuration where you can replicate the &#34;deployment&#34; in a few commands, you don&#39;t have any fancy stack to start things, but is awesome to automate and reply your software in a ease way.</p>
<p>
Follow the Sig-APPS community for the latest news.</p>
</div>
</div>
<div id="outline-container-headline-16" class="outline-3">
<h3 id="headline-16">
Reference
</h3>
<div id="outline-text-headline-16" class="outline-text-3">
<div id="outline-container-headline-17" class="outline-5">
<h5 id="headline-17">
[1] <a href="https://www.amazon.com/Continuous-Delivery-Deployment-Automation-Addison-Wesley/dp/0321601912/183-9249231-2275620?ie=UTF8&amp;redirect=true">https://www.amazon.com/Continuous-Delivery-Deployment-Automation-Addison-Wesley/dp/0321601912/183-9249231-2275620?ie=UTF8&amp;redirect=true</a>
</h5>
</div>
<div id="outline-container-headline-18" class="outline-5">
<h5 id="headline-18">
[2] Building Microservices
</h5>
</div>
<div id="outline-container-headline-19" class="outline-5">
<h5 id="headline-19">
[3] <a href="https://www.cloudbees.com/continuous-delivery/jenkins-docker">https://www.cloudbees.com/continuous-delivery/jenkins-docker</a>
</h5>
</div>
<div id="outline-container-headline-20" class="outline-5">
<h5 id="headline-20">
[4] <a href="http://deis.com/workflow/">http://deis.com/workflow/</a>
</h5>
</div>
<div id="outline-container-headline-21" class="outline-5">
<h5 id="headline-21">
[5] <a href="https://deis.com/docs/workflow/understanding-workflow/concepts/#build-release-run">https://deis.com/docs/workflow/understanding-workflow/concepts/#build-release-run</a>
</h5>
</div>
<div id="outline-container-headline-22" class="outline-5">
<h5 id="headline-22">
[6] <a href="https://github.com/deis/builder">https://github.com/deis/builder</a>
</h5>
</div>
<div id="outline-container-headline-23" class="outline-5">
<h5 id="headline-23">
[7] <a href="https://github.com/olalonde/deisdash">https://github.com/olalonde/deisdash</a>
</h5>
</div>
<div id="outline-container-headline-24" class="outline-5">
<h5 id="headline-24">
[8] <a href="http://helm.sh">http://helm.sh</a>
</h5>
</div>
<div id="outline-container-headline-25" class="outline-5">
<h5 id="headline-25">
[9] <a href="https://github.com/kubernetes/community/tree/master/sig-apps">https://github.com/kubernetes/community/tree/master/sig-apps</a>
</h5>
</div>
</div>
</div>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/2016/1216/apk/" title="Android APK hacking"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/2016/0618/ecto/" title="Ecto vs. Django ORM" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1755014861"></script>
    <script src="/js/perfect-scrollbar.min.js?1755014861"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1755014861"></script>
    <script src="/js/jquery.sticky.js?1755014861"></script>
    <script src="/js/featherlight.min.js?1755014861"></script>
    <script src="/js/highlight.pack.js?1755014861"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1755014861"></script>
    <script src="/js/learn.js?1755014861"></script>
    <script src="/js/hugo-learn.js?1755014861"></script>
    
        
            <script src="/mermaid/mermaid.js?1755014861"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

