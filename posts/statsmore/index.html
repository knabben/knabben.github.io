<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>AK  | More statistics and Python</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.54.0" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.e08a958ae3e530145318b6373195c765.css" rel="stylesheet">
    

    

    
      
    

    

    <meta property="og:title" content="More statistics and Python" />
<meta property="og:description" content="Simple linear regression Introduction This is again a collection of notes about stats and finance, with focus on covariance, correlation and simple linear regression, the idea here is to analyse some tools to measure risk. For a better representation let&#39;s get some Bovespa companies from the sector of Cyclic Consumption, they are: MGLU3, BTOW3, LAME3, LREN3.
Getting financial data import pandas as pd import numpy as np import pandas_datareader as web import matplotlib." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://knabben.github.io/posts/statsmore/" />
<meta property="article:published_time" content="2017-10-12T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2017-10-12T00:00:00&#43;00:00"/>

<meta itemprop="name" content="More statistics and Python">
<meta itemprop="description" content="Simple linear regression Introduction This is again a collection of notes about stats and finance, with focus on covariance, correlation and simple linear regression, the idea here is to analyse some tools to measure risk. For a better representation let&#39;s get some Bovespa companies from the sector of Cyclic Consumption, they are: MGLU3, BTOW3, LAME3, LREN3.
Getting financial data import pandas as pd import numpy as np import pandas_datareader as web import matplotlib.">


<meta itemprop="datePublished" content="2017-10-12T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2017-10-12T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1131">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="More statistics and Python"/>
<meta name="twitter:description" content="Simple linear regression Introduction This is again a collection of notes about stats and finance, with focus on covariance, correlation and simple linear regression, the idea here is to analyse some tools to measure risk. For a better representation let&#39;s get some Bovespa companies from the sector of Cyclic Consumption, they are: MGLU3, BTOW3, LAME3, LREN3.
Getting financial data import pandas as pd import numpy as np import pandas_datareader as web import matplotlib."/>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="http://knabben.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      AK
    </a>
    <div class="flex-l items-center">
      
      









    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  <article class="flex-l flex-wrap justify-between mw8 center ph3 ph0-l">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        POSTS
      </p>
      <h1 class="f1 athelas mb1">More statistics and Python</h1>
      
      <time class="f6 mv4 dib tracked" datetime="2017-10-12T00:00:00Z">October 12, 2017</time>
    </header>

    <main class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><h1 id="simple-linear-regression">Simple linear regression</h1>

<h2 id="introduction">Introduction</h2>

<p>This is again a collection of notes about stats and finance, with focus on covariance, correlation and simple linear regression, the idea here is to analyse some tools to measure risk. For a better representation let's get some Bovespa companies from the sector of Cyclic Consumption, they are: MGLU3, BTOW3, LAME3, LREN3.</p>

<h3 id="getting-financial-data">Getting financial data</h3>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas_datareader <span style="color:#f92672">as</span> web
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">from</span> pandas.plotting <span style="color:#f92672">import</span> scatter_matrix
<span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime, timedelta

<span style="color:#f92672">%</span>matplotlib inline

end <span style="color:#f92672">=</span> datetime<span style="color:#f92672">.</span>now()
start <span style="color:#f92672">=</span> end <span style="color:#f92672">-</span> timedelta(days<span style="color:#f92672">=</span><span style="color:#ae81ff">365</span>)

<span style="color:#75715e"># Fetch historiacal data</span>
sec_data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame()
<span style="color:#66d9ef">for</span> symbol <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#39;MGLU3&#39;</span>, <span style="color:#e6db74">&#39;BTOW3&#39;</span>, <span style="color:#e6db74">&#39;LAME3&#39;</span>, <span style="color:#e6db74">&#39;LREN3&#39;</span>]:
    sec_data[symbol] <span style="color:#f92672">=</span> web<span style="color:#f92672">.</span>DataReader(<span style="color:#e6db74">&#39;BVMF:{}&#39;</span><span style="color:#f92672">.</span>format(symbol),
                                      <span style="color:#e6db74">&#39;google&#39;</span>, start, end)[<span style="color:#e6db74">&#39;Close&#39;</span>]

<span style="color:#75715e"># Shift percent return</span>
sec_returns <span style="color:#f92672">=</span> sec_data<span style="color:#f92672">.</span>pct_change(<span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">1</span>:]

<span style="color:#75715e"># Plot the cumulative sum of return</span>
sec_returns<span style="color:#f92672">.</span>cumsum()<span style="color:#f92672">.</span>plot()</code></pre></div>

<p><img src="cumsum.png" alt="cumsum.png" title="cumsum.png" /></p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
<span style="color:#75715e"># Some numbers about the anual return</span>
<span style="color:#66d9ef">print</span>(sec_returns<span style="color:#f92672">.</span>mean() <span style="color:#f92672">*</span> <span style="color:#ae81ff">250</span>)
  MGLU3    <span style="color:#ae81ff">2.234703</span>
  BTOW3    <span style="color:#ae81ff">0.577344</span>
  LAME3    <span style="color:#ae81ff">0.173837</span>
  LREN3    <span style="color:#ae81ff">0.497388</span>

<span style="color:#66d9ef">print</span>(sec_returns<span style="color:#f92672">.</span>std() <span style="color:#f92672">*</span> <span style="color:#ae81ff">250</span> <span style="color:#f92672">**</span> <span style="color:#ae81ff">0.5</span>)
  MGLU3    <span style="color:#ae81ff">0.744661</span>
  BTOW3    <span style="color:#ae81ff">0.534165</span>
  LAME3    <span style="color:#ae81ff">0.261230</span>
  LREN3    <span style="color:#ae81ff">0.290350</span>

<span style="color:#75715e"># Returns of the histogram</span>
sec_returns<span style="color:#f92672">.</span>hist(bins<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>);</code></pre></div>

<p><img src="histogram-50.png" alt="histogram-50.png" title="histogram-50.png" /></p>

<h3 id="covariance">Covariance</h3>

<p>Study the relationship between values, this evaluates how the variables X and Y moves at the same time in relation it's mean values.</p>

<p>$$COV(a,b) = \frac{\sum_{k=1}(Ra - \overline{R}a) * (Rb - \overline{R}b)}{n}$$</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
sec_returns<span style="color:#f92672">.</span>var() <span style="color:#f92672">*</span> <span style="color:#ae81ff">250</span>

  MGLU3    <span style="color:#ae81ff">0.554520</span>
  BTOW3    <span style="color:#ae81ff">0.285332</span>
  LAME3    <span style="color:#ae81ff">0.068241</span>
  LREN3    <span style="color:#ae81ff">0.084303</span>

<span style="color:#75715e"># Covariance matrix</span>
sec_returns<span style="color:#f92672">.</span>cov() <span style="color:#f92672">*</span> <span style="color:#ae81ff">250</span>

          MGLU3     BTOW3     LAME3     LREN3      IBOV
MGLU3  <span style="color:#ae81ff">0.554520</span>  <span style="color:#ae81ff">0.091651</span>  <span style="color:#ae81ff">0.067703</span>  <span style="color:#ae81ff">0.038393</span>  <span style="color:#ae81ff">0.054705</span>
BTOW3  <span style="color:#ae81ff">0.091651</span>  <span style="color:#ae81ff">0.285332</span>  <span style="color:#ae81ff">0.079719</span>  <span style="color:#ae81ff">0.051221</span>  <span style="color:#ae81ff">0.048674</span>
LAME3  <span style="color:#ae81ff">0.067703</span>  <span style="color:#ae81ff">0.079719</span>  <span style="color:#ae81ff">0.068241</span>  <span style="color:#ae81ff">0.042511</span>  <span style="color:#ae81ff">0.034721</span>
LREN3  <span style="color:#ae81ff">0.038393</span>  <span style="color:#ae81ff">0.051221</span>  <span style="color:#ae81ff">0.042511</span>  <span style="color:#ae81ff">0.084303</span>  <span style="color:#ae81ff">0.040986</span>
IBOV   <span style="color:#ae81ff">0.054705</span>  <span style="color:#ae81ff">0.048674</span>  <span style="color:#ae81ff">0.034721</span>  <span style="color:#ae81ff">0.040986</span>  <span style="color:#ae81ff">0.042769</span>

<span style="color:#75715e"># Scatter matrix between stocks</span>
scatter_matrix(sec_returns, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">8</span>), alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, hist_kwds<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;bins&#39;</span>:<span style="color:#ae81ff">50</span>});</code></pre></div>

<p><img src="scatter-stock.png" alt="scatter-stock.png" title="scatter-stock.png" /></p>

<h3 id="correlation">Correlation</h3>

<p>Is simply a normalized form of covariance.</p>

<p>$$ CORRx,y = \frac{COVx,y}{\sigma{x}*\sigma{y}} $$</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
sec_returns<span style="color:#f92672">.</span>corr()

          MGLU3     BTOW3     LAME3     LREN3      IBOV
MGLU3  <span style="color:#ae81ff">1.000000</span>  <span style="color:#ae81ff">0.230411</span>  <span style="color:#ae81ff">0.348039</span>  <span style="color:#ae81ff">0.177572</span>  <span style="color:#ae81ff">0.355224</span>
BTOW3  <span style="color:#ae81ff">0.230411</span>  <span style="color:#ae81ff">1.000000</span>  <span style="color:#ae81ff">0.571298</span>  <span style="color:#ae81ff">0.330259</span>  <span style="color:#ae81ff">0.440611</span>
LAME3  <span style="color:#ae81ff">0.348039</span>  <span style="color:#ae81ff">0.571298</span>  <span style="color:#ae81ff">1.000000</span>  <span style="color:#ae81ff">0.560470</span>  <span style="color:#ae81ff">0.642699</span>
LREN3  <span style="color:#ae81ff">0.177572</span>  <span style="color:#ae81ff">0.330259</span>  <span style="color:#ae81ff">0.560470</span>  <span style="color:#ae81ff">1.000000</span>  <span style="color:#ae81ff">0.682574</span>
IBOV   <span style="color:#ae81ff">0.355224</span>  <span style="color:#ae81ff">0.440611</span>  <span style="color:#ae81ff">0.642699</span>  <span style="color:#ae81ff">0.682574</span>  <span style="color:#ae81ff">1.000000</span></code></pre></div>

<h3 id="linear-regression">Linear Regression</h3>

<p>$$ Y = \beta + \alpha * X $$</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
<span style="color:#f92672">import</span> statsmodels.api <span style="color:#f92672">as</span> sm

<span style="color:#75715e"># Fetch Ibovespa index</span>
sec_returns[<span style="color:#e6db74">&#39;IBOV&#39;</span>] <span style="color:#f92672">=</span> web<span style="color:#f92672">.</span>DataReader(
    <span style="color:#e6db74">&#39;INDEXBVMF:IBOV&#39;</span><span style="color:#f92672">.</span>format(symbol), <span style="color:#e6db74">&#39;google&#39;</span>, start, end
)[<span style="color:#e6db74">&#39;Close&#39;</span>]<span style="color:#f92672">.</span>pct_change(<span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">1</span>:]

<span style="color:#66d9ef">print</span>(sec_returns<span style="color:#f92672">.</span>head())</code></pre></div>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-markdown" data-lang="markdown"> <span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>                   MGLU3     BTOW3     LAME3     LREN3      IBOV<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    Date                                                        <span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    2016-10-14  0.028029  0.004507  0.027834  0.012278  0.010613<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    2016-10-17 -0.010554  0.038462  0.009247  0.011292  0.015039<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    2016-10-18  0.011556  0.039506  0.024869  0.015302  0.017323<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    2016-10-19  0.010545  0.010689  0.001916 -0.001629 -0.004337<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>    2016-10-20  0.000000  0.013514 -0.001912  0.001632  0.005232</code></pre></div>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
<span style="color:#75715e"># Calculate the alfa and beta for LAME3</span>
X <span style="color:#f92672">=</span> sec_returns[<span style="color:#e6db74">&#39;IBOV&#39;</span>]
Y <span style="color:#f92672">=</span> sec_returns[<span style="color:#e6db74">&#39;LAME3&#39;</span>]
result <span style="color:#f92672">=</span> sm<span style="color:#f92672">.</span>regression<span style="color:#f92672">.</span>linear_model<span style="color:#f92672">.</span>OLS(Y, sm<span style="color:#f92672">.</span>add_constant(X))<span style="color:#f92672">.</span>fit()
result<span style="color:#f92672">.</span>summary()</code></pre></div>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-markdown" data-lang="markdown">                          OLS Regression Results                            <span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>==============================================================================<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Dep. Variable:                  LAME3   R-squared:                       0.413<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Model:                            OLS   Adj. R-squared:                  0.411<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Method:                 Least Squares   F-statistic:                     173.1<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Date:                Thu, 12 Oct 2017   Prob (F-statistic):           2.71e-30<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Time:                        21:31:42   Log-Likelihood:                 732.24<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>No. Observations:                 248   AIC:                            -1460.<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Df Residuals:                     246   BIC:                            -1453.<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Df Model:                           1                                         <span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Covariance Type:            nonrobust                                         <span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>==============================================================================<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>                 coef    std err          t      P&gt;|t|      [0.025      0.975]<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>------------------------------------------------------------------------------<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>const         -0.0001      0.001     -0.144      0.885      -0.002       0.001<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>IBOV           0.8118      0.062     13.158      0.000       0.690       0.933<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>==============================================================================<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Omnibus:                       14.069   Durbin-Watson:                   2.021<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Prob(Omnibus):                  0.001   Jarque-Bera (JB):               30.752<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Skew:                          -0.205   Prob(JB):                     2.10e-07<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>Kurtosis:                       4.675   Cond. No.                         76.6<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>==============================================================================</code></pre></div>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
a <span style="color:#f92672">=</span> result<span style="color:#f92672">.</span>params[<span style="color:#ae81ff">0</span>]
b <span style="color:#f92672">=</span> result<span style="color:#f92672">.</span>params[<span style="color:#ae81ff">1</span>]
X2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(X<span style="color:#f92672">.</span>min(), X<span style="color:#f92672">.</span>max(), <span style="color:#ae81ff">100</span>)
Y_hat <span style="color:#f92672">=</span> X2 <span style="color:#f92672">*</span> b <span style="color:#f92672">+</span> a
plt<span style="color:#f92672">.</span>scatter(X, Y, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>);
plt<span style="color:#f92672">.</span>plot(X2, Y_hat, <span style="color:#e6db74">&#39;r&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>);
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Ibov Value&#39;</span>);
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;LAME3 Value&#39;</span>);</code></pre></div>

<p><img src="linear-reg-lame3.png" alt="linear-reg-lame3.png" title="linear-reg-lame3.png" /></p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
<span style="color:#f92672">***</span> Exercises: Suppose those are the grades of some students, answer the following: 
<span style="color:#75715e"># a) what is the correlation coeficient of these variables and the type of relation</span>
<span style="color:#75715e"># b) construct the equation finding alfa and beta</span>
<span style="color:#75715e"># c) If the student takes a 6.5 on math what is his note in biology?</span></code></pre></div>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
<span style="color:#f92672">from</span> scipy <span style="color:#f92672">import</span> stats

df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
    <span style="color:#e6db74">&#39;math&#39;</span>: [<span style="color:#ae81ff">9.5</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8.5</span>, <span style="color:#ae81ff">8.0</span>, <span style="color:#ae81ff">8.0</span>, <span style="color:#ae81ff">7.5</span>, <span style="color:#ae81ff">7.5</span>, <span style="color:#ae81ff">6.0</span>, <span style="color:#ae81ff">5.0</span>, <span style="color:#ae81ff">4.0</span>],
    <span style="color:#e6db74">&#39;bio&#39;</span>: [<span style="color:#ae81ff">3.4</span>, <span style="color:#ae81ff">5.4</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">7.5</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">8</span>]
})

df[<span style="color:#e6db74">&#39;x.y&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;math&#39;</span>] <span style="color:#f92672">*</span> df[<span style="color:#e6db74">&#39;bio&#39;</span>]
df[<span style="color:#e6db74">&#39;x2&#39;</span>] <span style="color:#f92672">=</span> round(df[<span style="color:#e6db74">&#39;math&#39;</span>] <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
df[<span style="color:#e6db74">&#39;y2&#39;</span>] <span style="color:#f92672">=</span> round(df[<span style="color:#e6db74">&#39;bio&#39;</span>] <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
plt<span style="color:#f92672">.</span>scatter(df[<span style="color:#e6db74">&#39;math&#39;</span>], df[<span style="color:#e6db74">&#39;bio&#39;</span>])</code></pre></div>

<p><img src="exercise-linear.png" alt="exercise-linear.png" title="exercise-linear.png" /></p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
Answer:
a)
np<span style="color:#f92672">.</span>corrcoef(df[<span style="color:#e6db74">&#39;math&#39;</span>], df[<span style="color:#e6db74">&#39;bio&#39;</span>])[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>]
<span style="color:#f92672">-</span><span style="color:#ae81ff">0.73842044735499168</span>

b)
stat <span style="color:#f92672">=</span> stats<span style="color:#f92672">.</span>linregress(df[<span style="color:#e6db74">&#39;math&#39;</span>], df[<span style="color:#e6db74">&#39;bio&#39;</span>])
slope <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.7042</span>
intercept <span style="color:#f92672">=</span> <span style="color:#ae81ff">11.67117</span>

c) stat<span style="color:#f92672">.</span>intercept <span style="color:#f92672">+</span> (stat<span style="color:#f92672">.</span>slope <span style="color:#f92672">*</span> <span style="color:#ae81ff">6.5</span>)
<span style="color:#ae81ff">7.0934163701067607</span></code></pre></div>

<h1 id="anova">ANOVA</h1>

<p>Variance analysis is a way to test the validity of a null hypothesis and check if the arithmetic means of two or populations are equal. For this case, it is being analyzed three different methods of teaching, and the student's grade for each method, having a significance level of 1%.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">%</span>matplotlib inline

data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame({
    <span style="color:#e6db74">&#39;I&#39;</span>: [<span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">87</span>],
    <span style="color:#e6db74">&#39;II&#39;</span>: [<span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">90</span>],
    <span style="color:#e6db74">&#39;III&#39;</span>: [<span style="color:#ae81ff">84</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">74</span>, <span style="color:#ae81ff">67</span>]
})

data<span style="color:#f92672">.</span>boxplot()</code></pre></div>

<p><img src="boxplot-anova.png" alt="boxplot-anova.png" title="boxplot-anova.png" /></p>

<h3 id="testing-in-4-steps">Testing in 4 steps</h3>

<p>1) The first step is declare the null hypothesis and the alternative hypothese</p>

<h5 id="h0-u1-u2-u3">H0: u1 = u2 = u3</h5>

<h5 id="h1-the-means-aren-t-equal">H1: The means aren't equal.</h5>

<p>2) Defining the critical region</p>

<p>For setting the degree of freedom we have, being k the number of methods and n the total number of observations:</p>

<h5 id="df1-k-1-3-1-2">df1: k - 1 = 3 - 1 = 2</h5>

<h5 id="df2-n-k-15-3-12">df2: n - k = 15 - 3 = 12</h5>

<p>Following the df(2,12) we can find the critical value = 6.93 in the F distribution table with an alpha of 0.01</p>

<p>http://www.socr.ucla.edu/applets.dir/f_table.html#FTable0.01</p>

<p>3) We can use scipy stats to fetch the F-value between the three methods</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
<span style="color:#f92672">import</span> scipy.stats <span style="color:#f92672">as</span> stats
f_value, _ <span style="color:#f92672">=</span> stats<span style="color:#f92672">.</span>f_oneway(data[<span style="color:#e6db74">&#39;I&#39;</span>], data[<span style="color:#e6db74">&#39;II&#39;</span>], data[<span style="color:#e6db74">&#39;III&#39;</span>])
<span style="color:#ae81ff">1.092717464598786</span></code></pre></div>

<p>4) Take a decision</p>

<p>We have the F_value = 1.09 < critical_value = 6.93, and cannot reject the null hypothesis what finishes the conclusion: the arithmetic mean are equal for the three population</p>

<h3 id="exercises">Exercises</h3>

<p>A director of a company wants to buy a new screw machine, you must learn about the brands from a determined period each one independently makes the following number of screws, our null hypothesis here is to confirm there's no difference between the mean volume of pieces each machine can build. The significance level is 5%.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> 
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

machine_I <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>])
machine_II <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>])
machine_III <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>])

n <span style="color:#f92672">=</span> len(machine_I) <span style="color:#f92672">+</span> len(machine_II) <span style="color:#f92672">+</span> len(machine_III)
k <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>

<span style="color:#75715e"># Defining the degrees of freedom</span>
df1 <span style="color:#f92672">=</span> k <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
df2 <span style="color:#f92672">=</span> n <span style="color:#f92672">-</span> k
<span style="color:#75715e"># dg(2,15)</span>

np_m1 <span style="color:#f92672">=</span> round(machine_I<span style="color:#f92672">.</span>mean(), <span style="color:#ae81ff">2</span>)
np_m2 <span style="color:#f92672">=</span> round(machine_II<span style="color:#f92672">.</span>mean(), <span style="color:#ae81ff">2</span>)
np_m3 <span style="color:#f92672">=</span> round(machine_III<span style="color:#f92672">.</span>mean(), <span style="color:#ae81ff">2</span>)
<span style="color:#75715e"># 6.4 9.57 6.33</span>

total_mean <span style="color:#f92672">=</span> (np_m1 <span style="color:#f92672">+</span> np_m2 <span style="color:#f92672">+</span> np_m3) <span style="color:#f92672">/</span> k
<span style="color:#75715e"># 7.43333333333</span>

<span style="color:#75715e"># Calculating the sum of squares due to the source BETWEEN</span>
SSB <span style="color:#f92672">=</span> (
    (len(machine_I) <span style="color:#f92672">*</span> (np_m1 <span style="color:#f92672">-</span> total_mean) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span>
    (len(machine_II) <span style="color:#f92672">*</span> (np_m2 <span style="color:#f92672">-</span> total_mean) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span>
    (len(machine_III) <span style="color:#f92672">*</span> (np_m3 <span style="color:#f92672">-</span> total_mean) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>)
)
<span style="color:#75715e"># 44.6003666667</span>
MSB <span style="color:#f92672">=</span> SSB <span style="color:#f92672">/</span> df1
<span style="color:#75715e"># 22.3001833333</span>

<span style="color:#75715e"># Calculating the sum of squares due to the source RESIDUAL</span>
SSE1 <span style="color:#f92672">=</span> round(((np_m1 <span style="color:#f92672">-</span> machine_I)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">.</span>sum(), <span style="color:#ae81ff">2</span>)
SSE2 <span style="color:#f92672">=</span> round(((np_m2 <span style="color:#f92672">-</span> machine_II)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">.</span>sum(), <span style="color:#ae81ff">2</span>)
SSE3 <span style="color:#f92672">=</span> round(((np_m3 <span style="color:#f92672">-</span> machine_III)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">.</span>sum(), <span style="color:#ae81ff">2</span>)
<span style="color:#75715e"># 5.2 17.71 7.33</span>

total_SSE <span style="color:#f92672">=</span> sum([SSE1, SSE2, SSE3])
<span style="color:#75715e"># 30.24</span>

MSE <span style="color:#f92672">=</span> total_SSB <span style="color:#f92672">/</span> df2
<span style="color:#75715e"># 2.016</span>

F_value <span style="color:#f92672">=</span> MSE <span style="color:#f92672">/</span> MSB
<span style="color:#75715e"># 11.06</span>

<span style="color:#75715e"># for alpha = 0.5 - http://www.socr.ucla.edu/applets.dir/f_table.html#FTable0.05</span>
null_hypothesis_true <span style="color:#f92672">=</span> f_value <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">3.68</span></code></pre></div>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-markdown" data-lang="markdown">| source | SS     | DF | MS     | F     |<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>| ------ | ------ | -- | ------ | ----- |<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>| factor | 44.60  | 2  | 22.30  | 11.06 |<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>| error  | 30.24  | 15 | 2.01   |       |<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>| total  | 74.84  | 17 |        |       |</code></pre></div>
<ul class="pa0">
  
</ul>
<div class="mt6">
        
      </div>
    </main>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <script type="text/javascript" async
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
 MathJax.Hub.Config({
   tex2jax: {
     inlineMath: [['$','$'], ['\\(','\\)']],
     displayMath: [['$$','$$']],
     processEscapes: true,
     processEnvironments: true,
     skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
     TeX: { equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "AMSsymbols.js"] }
   }
 });
 MathJax.Hub.Queue(function() {
   
   
   
   var all = MathJax.Hub.getAllJax(), i;
   for(i = 0; i < all.length; i += 1) {
     all[i].SourceElement().parentNode.className += ' has-jax';
   }
 });

 MathJax.Hub.Config({
   
   TeX: { equationNumbers: { autoNumber: "AMS" } }
 });
</script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-46699622-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<footer class="bg-near-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://knabben.github.io/" >
    &copy; 2019 AK
  </a>
    <div>








</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
